<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<title>GAP (ref) - Chapter 47: Finitely Presented Groups</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="GAPDoc2HTML" />
<link rel="stylesheet" type="text/css" href="manual.css" />
<script src="manual.js" type="text/javascript"></script>
<script type="text/javascript">overwriteStyle();</script>
</head>
<body class="chap47"  onload="jscontent()">


<div class="chlinktop"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chap4_mj.html">4</a>  <a href="chap5_mj.html">5</a>  <a href="chap6_mj.html">6</a>  <a href="chap7_mj.html">7</a>  <a href="chap8_mj.html">8</a>  <a href="chap9_mj.html">9</a>  <a href="chap10_mj.html">10</a>  <a href="chap11_mj.html">11</a>  <a href="chap12_mj.html">12</a>  <a href="chap13_mj.html">13</a>  <a href="chap14_mj.html">14</a>  <a href="chap15_mj.html">15</a>  <a href="chap16_mj.html">16</a>  <a href="chap17_mj.html">17</a>  <a href="chap18_mj.html">18</a>  <a href="chap19_mj.html">19</a>  <a href="chap20_mj.html">20</a>  <a href="chap21_mj.html">21</a>  <a href="chap22_mj.html">22</a>  <a href="chap23_mj.html">23</a>  <a href="chap24_mj.html">24</a>  <a href="chap25_mj.html">25</a>  <a href="chap26_mj.html">26</a>  <a href="chap27_mj.html">27</a>  <a href="chap28_mj.html">28</a>  <a href="chap29_mj.html">29</a>  <a href="chap30_mj.html">30</a>  <a href="chap31_mj.html">31</a>  <a href="chap32_mj.html">32</a>  <a href="chap33_mj.html">33</a>  <a href="chap34_mj.html">34</a>  <a href="chap35_mj.html">35</a>  <a href="chap36_mj.html">36</a>  <a href="chap37_mj.html">37</a>  <a href="chap38_mj.html">38</a>  <a href="chap39_mj.html">39</a>  <a href="chap40_mj.html">40</a>  <a href="chap41_mj.html">41</a>  <a href="chap42_mj.html">42</a>  <a href="chap43_mj.html">43</a>  <a href="chap44_mj.html">44</a>  <a href="chap45_mj.html">45</a>  <a href="chap46_mj.html">46</a>  <a href="chap47_mj.html">47</a>  <a href="chap48_mj.html">48</a>  <a href="chap49_mj.html">49</a>  <a href="chap50_mj.html">50</a>  <a href="chap51_mj.html">51</a>  <a href="chap52_mj.html">52</a>  <a href="chap53_mj.html">53</a>  <a href="chap54_mj.html">54</a>  <a href="chap55_mj.html">55</a>  <a href="chap56_mj.html">56</a>  <a href="chap57_mj.html">57</a>  <a href="chap58_mj.html">58</a>  <a href="chap59_mj.html">59</a>  <a href="chap60_mj.html">60</a>  <a href="chap61_mj.html">61</a>  <a href="chap62_mj.html">62</a>  <a href="chap63_mj.html">63</a>  <a href="chap64_mj.html">64</a>  <a href="chap65_mj.html">65</a>  <a href="chap66_mj.html">66</a>  <a href="chap67_mj.html">67</a>  <a href="chap68_mj.html">68</a>  <a href="chap69_mj.html">69</a>  <a href="chap70_mj.html">70</a>  <a href="chap71_mj.html">71</a>  <a href="chap72_mj.html">72</a>  <a href="chap73_mj.html">73</a>  <a href="chap74_mj.html">74</a>  <a href="chap75_mj.html">75</a>  <a href="chap76_mj.html">76</a>  <a href="chap77_mj.html">77</a>  <a href="chap78_mj.html">78</a>  <a href="chap79_mj.html">79</a>  <a href="chap80_mj.html">80</a>  <a href="chap81_mj.html">81</a>  <a href="chap82_mj.html">82</a>  <a href="chap83_mj.html">83</a>  <a href="chap84_mj.html">84</a>  <a href="chap85_mj.html">85</a>  <a href="chap86_mj.html">86</a>  <a href="chap87_mj.html">87</a>  <a href="chapBib_mj.html">Bib</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<div class="chlinkprevnexttop">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap46_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap48_mj.html">[Next Chapter]</a>&nbsp;  </div>

<p id="mathjaxlink" class="pcenter"><a href="chap47.html">[MathJax off]</a></p>
<p><a id="X7AA982637E90B35A" name="X7AA982637E90B35A"></a></p>
<div class="ChapSects"><a href="chap47_mj.html#X7AA982637E90B35A">47 <span class="Heading">Finitely Presented Groups</span></a>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X7824C8167B3CFAB1">47.1 <span class="Heading">IsSubgroupFpGroup and IsFpGroup</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7AF7E2B48199452C">47.1-1 IsSubgroupFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X850B9DF17D90C3A2">47.1-2 IsFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X8370BF3B78D0B14D">47.1-3 InfoFpGroup</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X7D55E56E790F85FD">47.2 <span class="Heading">Creating Finitely Presented Groups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7EF4179E78BC7313"><code>47.2-1 \/</code></a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7CE0FA5F8695241E">47.2-2 FactorGroupFpGroupByRels</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7B3D290B87B6EFE4">47.2-3 ParseRelators</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85EAA789848B528E">47.2-4 StringFactorizationWord</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X84D693EC872DAA55">47.3 <span class="Heading">Comparison of Elements of Finitely Presented Groups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X797D29628203CBD6"><code>47.3-1 \=</code></a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7B350C718573B8DF"><code>47.3-2 \&lt;</code></a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X87512CF485CC4128">47.3-3 FpElmComparisonMethod</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X82CB9EC982CDAEAC">47.3-4 SetReducedMultiplication</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X7B0B2781796800AD">47.4 <span class="Heading">Preimages in the Free Group</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85CF3931849FB441">47.4-1 FreeGroupOfFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X79C77C5184CA02B6">47.4-2 FreeGeneratorsOfFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X87BA180287CD1F71">47.4-3 RelatorsOfFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X8447A2397A1E524B">47.4-4 UnderlyingElement</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7F34C8017DC03FDB">47.4-5 ElementOfFpGroup</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X869143D284F3379D">47.5 <span class="Heading">Operations for Finitely Presented Groups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7AB7187779EDC9BA">47.5-1 PseudoRandom</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X7BD0CEBA7B225416">47.6 <span class="Heading">Coset Tables and Coset Enumeration</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7F7F31E47D7F6EF8">47.6-1 CosetTable</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X87D175757C581E62">47.6-2 TracedCosetFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7EC1B0EE876E478A">47.6-3 FactorCosetAction</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X82926A7F8365A341">47.6-4 CosetTableBySubgroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7DE601F179E6FD09">47.6-5 CosetTableFromGensAndRels</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X822B188F87E9E642">47.6-6 CosetTableDefaultMaxLimit</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7A80A00E7E088E44">47.6-7 CosetTableDefaultLimit</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X829D31A981CB2AF4">47.6-8 MostFrequentGeneratorFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7912E6577B577A5C">47.6-9 IndicesInvolutaryGenerators</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X85B882F782D7AFD0">47.7 <span class="Heading">Standardization of coset tables</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85FD1D637EF1EBE7">47.7-1 CosetTableStandard</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85FCD8DF81BA94D5">47.7-2 StandardizeTable</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X87C3FA0784A85309">47.8 <span class="Heading">Coset tables for subgroups in the whole group</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X846EC8AB7803114D">47.8-1 CosetTableInWholeGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X857F239583AFE0B7">47.8-2 SubgroupOfWholeGroupByCosetTable</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X7E17A14E823F953D">47.9 <span class="Heading">Augmented Coset Tables and Rewriting</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X80F8BF1D867DA7C1">47.9-1 AugmentedCosetTableInWholeGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7AF67CFD846C1159">47.9-2 AugmentedCosetTableMtc</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7F3F09C778552811">47.9-3 AugmentedCosetTableRrs</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X86B65EA186140244">47.9-4 RewriteWord</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X87FBDA2B815A8776">47.10 <span class="Heading">Low Index Subgroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85C5151380E19122">47.10-1 LowIndexSubgroupsFpGroupIterator</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X81003D217D92E342">47.11 <span class="Heading">Converting Groups to Finitely Presented Groups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7F28268F850F454E">47.11-1 IsomorphismFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X81B2B3B6812FD62D">47.11-2 IsomorphismFpGroupByGenerators</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X826604AA7F18BFA3">47.12 <span class="Heading">New Presentations and Presentations for Subgroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X78D87FA68233C401">47.12-1 IsomorphismSimplifiedFpGroup</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X86E7CE077D82133D">47.13 <span class="Heading">Preimages under Homomorphisms from an FpGroup</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7ABC3C917D41A74B">47.13-1 SubgroupOfWholeGroupByQuotientSubgroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X8047D7A37B27FEEA">47.13-2 IsSubgroupOfWholeGroupByQuotientRep</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X84E6CEA28611C112">47.13-3 AsSubgroupOfWholeGroupByQuotient</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7DA1151D84289FC9">47.13-4 DefiningQuotientHomomorphism</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X846072F779B51087">47.14 <span class="Heading">Quotient Methods</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7B5DDADC80F5796B">47.14-1 PQuotient</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X86EB30A7867EEF16">47.14-2 EpimorphismQuotientSystem</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7CA738DB80B20D67">47.14-3 EpimorphismPGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X7CA20E2582DC45FD">47.14-4 EpimorphismNilpotentQuotient</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X869F70CC818C946D">47.14-5 SolvableQuotient</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X79A4D3B68110F48A">47.14-6 EpimorphismSolvableQuotient</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X81167847832DD3B1">47.14-7 LargerQuotientBySubgroupAbelianization</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X81451C4B8463B848">47.15 <span class="Heading">Abelian Invariants for Subgroups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X83B63ED8826F4268">47.15-1 AbelianInvariantsSubgroupFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X804F664180BA2134">47.15-2 AbelianInvariantsSubgroupFpGroupMtc</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X8586137B7AAA6C10">47.15-3 <span class="Heading">AbelianInvariantsSubgroupFpGroupRrs</span></a>
</span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X850E4CD784F6EAA8">47.15-4 AbelianInvariantsNormalClosureFpGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X801635B28079E56A">47.15-5 AbelianInvariantsNormalClosureFpGroupRrs</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap47_mj.html#X86C43E3B81ED25DC">47.16 <span class="Heading">Testing Finiteness of Finitely Presented Groups</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X82F444F67BE0E4FE">47.16-1 IsInfiniteAbelianizationGroup</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap47_mj.html#X85C9FD548394C1E2">47.16-2 NewmanInfinityCriterion</a></span>
</div></div>
</div>

<h3>47 <span class="Heading">Finitely Presented Groups</span></h3>

<p>A <em>finitely presented group</em> (in short: FpGroup) is a group generated by a finite set of <em>abstract generators</em> subject to a finite set of <em>relations</em> that these generators satisfy. Every finite group can be represented as a finitely presented group, though in almost all cases it is computationally much more efficient to work in another representation (even the regular permutation representation).</p>

<p>Finitely presented groups are obtained by factoring a free group by a set of relators. Their elements know about this presentation and compare accordingly.</p>

<p>So to create a finitely presented group you first have to generate a free group (see <code class="func">FreeGroup</code> (<a href="chap37_mj.html#X8215999E835290F0"><span class="RefLink">37.2-1</span></a>) for details). There are two ways to specify a quotient of the free group: either by giving a list of relators or by giving a list of equations. Relators are just words in the generators of the free group. Equations are represented as pairs of words in the generators of the free group. In either case the generators of the quotient are <em>the images</em> of the free generators under the canonical homomorphism from the free group onto the quotient. So for example to create the group</p>

<p class="center">\[
\langle a, b \mid a^2, b^3, (a b)^5 \rangle
\]</p>

<p>you can use the following commands:</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( "a", "b" );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g := f / [ f.1^2, f.2^3, (f.1*f.2)^5 ];</span>
&lt;fp group on the generators [ a, b ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">h := f / [ [f.1^2, f.1^0], [f.2^3, f.1^0], [(f.1*f.2)^4, f.2^-1*f.1^-1] ];</span>
&lt;fp group on the generators [ a, b ]&gt;
</pre></div>

<p>Note that you cannot call the generators by their names. These names are not variables, but just display figures. So, if you want to access the generators by their names, you first have to introduce the respective variables and to assign the generators to them.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Unbind(a);</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfGroup( g );</span>
[ a, b ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a;</span>
Error, Variable: 'a' must have a value
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a := g.1;; b := g.2;; # assign variables</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfGroup( g );</span>
[ a, b ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a in f;</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a in g;</span>
true
</pre></div>

<p>To relieve you of the tedium of typing the above assignments, <em>when working interactively</em>, there is the function <code class="func">AssignGeneratorVariables</code> (<a href="chap37_mj.html#X814203E281F3272E"><span class="RefLink">37.2-3</span></a>).</p>

<p>Note that the generators of the free group are different from the generators of the FpGroup (even though they are displayed by the same names). That means that words in the generators of the free group are not elements of the finitely presented group. Vice versa elements of the FpGroup are not words.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a*b = b*a;</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">(b^2*a*b)^2 = a^0;</span>
true
</pre></div>

<p>Such calculations comparing elements of an FpGroup may run into problems: There exist finitely presented groups for which no algorithm exists (it is known that no such algorithm can exist) that will tell for two arbitrary words in the generators whether the corresponding elements in the FpGroup are equal.</p>

<p>Therefore the methods used by <strong class="pkg">GAP</strong> to compute in finitely presented groups may run into warning errors, run out of memory or run forever. If the FpGroup is (by theory) known to be finite the algorithms are guaranteed to terminate (if there is sufficient memory available), but the time needed for the calculation cannot be bounded a priori. See <a href="chap47_mj.html#X7BD0CEBA7B225416"><span class="RefLink">47.6</span></a> and <a href="chap47_mj.html#X86C43E3B81ED25DC"><span class="RefLink">47.16</span></a>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">(b^2*a*b)^2;</span>
(b^2*a*b)^2
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">a^0;</span>
&lt;identity ...&gt;
</pre></div>

<p>A consequence of our convention is that elements of finitely presented groups are not printed in a unique way. See also <code class="func">SetReducedMultiplication</code> (<a href="chap47_mj.html#X82CB9EC982CDAEAC"><span class="RefLink">47.3-4</span></a>).</p>

<p><a id="X7824C8167B3CFAB1" name="X7824C8167B3CFAB1"></a></p>

<h4>47.1 <span class="Heading">IsSubgroupFpGroup and IsFpGroup</span></h4>

<p><a id="X7AF7E2B48199452C" name="X7AF7E2B48199452C"></a></p>

<h5>47.1-1 IsSubgroupFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsSubgroupFpGroup</code>( <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;category&nbsp;)</td></tr></table></div>
<p>returns <code class="keyw">true</code> if <var class="Arg">H</var> is a finitely presented group or a subgroup of a finitely presented group.</p>

<p><a id="X850B9DF17D90C3A2" name="X850B9DF17D90C3A2"></a></p>

<h5>47.1-2 IsFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;filter&nbsp;)</td></tr></table></div>
<p>is a synonym for <code class="code">IsSubgroupFpGroup(<var class="Arg">G</var>) and IsGroupOfFamily(<var class="Arg">G</var>)</code>.</p>

<p>Free groups are a special case of finitely presented groups, namely finitely presented groups with no relators.</p>

<p>Another special case are groups given by polycyclic presentations. <strong class="pkg">GAP</strong> uses a special representation for these groups which is created in a different way. See chapter <a href="chap46_mj.html#X7EAD57C97EBF7E67"><span class="RefLink">46</span></a> for details.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=FreeGroup(2);</span>
&lt;free group on the generators [ f1, f2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsFpGroup(g);</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">h:=CyclicGroup(2);</span>
&lt;pc group of size 2 with 1 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsFpGroup(h);</span>
false
</pre></div>

<p><a id="X8370BF3B78D0B14D" name="X8370BF3B78D0B14D"></a></p>

<h5>47.1-3 InfoFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; InfoFpGroup</code></td><td class="tdright">(&nbsp;info class&nbsp;)</td></tr></table></div>
<p>The info class for functions dealing with finitely presented groups is <code class="func">InfoFpGroup</code>.</p>

<p><a id="X7D55E56E790F85FD" name="X7D55E56E790F85FD"></a></p>

<h4>47.2 <span class="Heading">Creating Finitely Presented Groups</span></h4>

<p><a id="X7EF4179E78BC7313" name="X7EF4179E78BC7313"></a></p>

<h5><code>47.2-1 \/</code></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; \/</code>( <var class="Arg">F</var>, <var class="Arg">rels</var> )</td><td class="tdright">(&nbsp;method&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; \/</code>( <var class="Arg">F</var>, <var class="Arg">eqns</var> )</td><td class="tdright">(&nbsp;method&nbsp;)</td></tr></table></div>
<p>creates a finitely presented group given by the presentation <span class="SimpleMath">\(\langle gens \mid \textit{rels} \rangle\)</span> or <span class="SimpleMath">\(\langle gens \mid \textit{eqns} \rangle\)</span>, respectively where <span class="SimpleMath">\(gens\)</span> are the free generators of the free group <var class="Arg">F</var>. Relations can be entered either as words or as pairs of words in the generators of <var class="Arg">F</var>. In the former case we refer to the words given as <em>relators</em>, in the latter we refer to the pairs of words as <em>equations</em>. The two methods can currently not be mixed.</p>

<p>The same result is obtained with the infix operator <code class="code">/</code>, i.e., as <var class="Arg">F</var> <code class="code">/</code> <var class="Arg">rels</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( 3 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f / [ f.1^4, f.2^3, f.3^5, f.1*f.2*f.3 ];</span>
&lt;fp group on the generators [ f1, f2, f3 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f / [ [ f.1^4, f.1^0 ], [ f.2^3, f.1^0 ], [ f.1, f.2^-1*f.3^-1 ] ];</span>
&lt;fp group on the generators [ f1, f2, f3 ]&gt;
</pre></div>

<p><a id="X7CE0FA5F8695241E" name="X7CE0FA5F8695241E"></a></p>

<h5>47.2-2 FactorGroupFpGroupByRels</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FactorGroupFpGroupByRels</code>( <var class="Arg">G</var>, <var class="Arg">elts</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>returns the factor group <var class="Arg">G</var>/<span class="SimpleMath">\(N\)</span> of <var class="Arg">G</var> by the normal closure <span class="SimpleMath">\(N\)</span> of <var class="Arg">elts</var> where <var class="Arg">elts</var> is expected to be a list of elements of <var class="Arg">G</var>.</p>

<p><a id="X7B3D290B87B6EFE4" name="X7B3D290B87B6EFE4"></a></p>

<h5>47.2-3 ParseRelators</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; ParseRelators</code>( <var class="Arg">gens</var>, <var class="Arg">rels</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Will translate a list of relations as given in print, e.g. <span class="SimpleMath">\(x y^2 = (x y^3 x)^2 xy = yzx\)</span> into relators. <var class="Arg">gens</var> must be a list of generators of a free group, each being displayed by a single letter. <var class="Arg">rels</var> is a string that lists a sequence of equalities. These must be written in the letters which are the names of the generators in <var class="Arg">gens</var>. Change of upper/lower case is interpreted to indicate inverses.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup("x","y","z");;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AssignGeneratorVariables(f);</span>
#I  Assigned the global variables [ x, y, z ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">r:=ParseRelators([x,y,z],</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">"x^2 = y^5 = z^3 = (xyxyxy^4)^2 = (xz)^2 = (y^2z)^2 = 1");</span>
[ x^2, y^5, z^3, (x*z)^2, (y^2*z)^2, ((x*y)^3*y^3)^2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=f/r;</span>
&lt;fp group on the generators [ x, y, z ]&gt;
</pre></div>

<p><a id="X85EAA789848B528E" name="X85EAA789848B528E"></a></p>

<h5>47.2-4 StringFactorizationWord</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; StringFactorizationWord</code>( <var class="Arg">w</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>returns a string that expresses a given word <var class="Arg">w</var> in compact form written as a string. Inverses are expressed by changing the upper/lower case of the generators, recurring expressions are written as products.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StringFactorizationWord(z^-1*x*y*y*y*x*x*y*y*y*x*y^-1*x);</span>
"Z(xy3x)2Yx"
</pre></div>

<p><a id="X84D693EC872DAA55" name="X84D693EC872DAA55"></a></p>

<h4>47.3 <span class="Heading">Comparison of Elements of Finitely Presented Groups</span></h4>

<p><a id="X797D29628203CBD6" name="X797D29628203CBD6"></a></p>

<h5><code>47.3-1 \=</code></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; \=</code>( <var class="Arg">a</var>, <var class="Arg">b</var> )</td><td class="tdright">(&nbsp;method&nbsp;)</td></tr></table></div>
<p>Two elements of a finitely presented group are equal if they are equal in this group. Nevertheless they may be represented as different words in the generators. Because of the fundamental problems mentioned in the introduction to this chapter such a test may take very long and cannot be guaranteed to finish.</p>

<p>The method employed by <strong class="pkg">GAP</strong> for such an equality test use the underlying finitely presented group. First (unless this group is known to be infinite) <strong class="pkg">GAP</strong> tries to find a faithful permutation representation by a bounded Todd-Coxeter. If this fails, a Knuth-Bendix (see <a href="chap52_mj.html#X87693BDC79DC6EBF"><span class="RefLink">52.5</span></a>) is attempted and the words are compared via their normal form.</p>

<p>If only elements in a subgroup are to be tested for equality it thus can be useful to translate the problem in a new finitely presented group by rewriting (see <code class="func">IsomorphismFpGroup</code> (<a href="chap47_mj.html#X7F28268F850F454E"><span class="RefLink">47.11-1</span></a>));</p>

<p>The equality test of elements underlies many "basic" calculations, such as the order of an element, and the same type of problems can arise there. In some cases, working with rewriting systems can still help to solve the problem. The <strong class="pkg">kbmag</strong> package provides such functionality, see the package manual for further details.</p>

<p><a id="X7B350C718573B8DF" name="X7B350C718573B8DF"></a></p>

<h5><code>47.3-2 \&lt;</code></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; \&lt;</code>( <var class="Arg">a</var>, <var class="Arg">b</var> )</td><td class="tdright">(&nbsp;method&nbsp;)</td></tr></table></div>
<p>Compared with equality testing, problems get even worse when trying to compute a total ordering on the elements of a finitely presented group. As any ordering that is guaranteed to be reproducible in different runs of <strong class="pkg">GAP</strong> or even with different groups given by syntactically equal presentations would be prohibitively expensive to implement, the ordering of elements is depending on a method chosen by <strong class="pkg">GAP</strong> and not guaranteed to stay the same when repeating the construction of an FpGroup. The only guarantee given for the <code class="code">&lt;</code> ordering for such elements is that it will stay the same for one family during its lifetime. The attribute <code class="func">FpElmComparisonMethod</code> (<a href="chap47_mj.html#X87512CF485CC4128"><span class="RefLink">47.3-3</span></a>) is used to obtain a comparison function for a family of FpGroup elements.</p>

<p><a id="X87512CF485CC4128" name="X87512CF485CC4128"></a></p>

<h5>47.3-3 FpElmComparisonMethod</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FpElmComparisonMethod</code>( <var class="Arg">fam</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>If <var class="Arg">fam</var> is the elements family of a finitely presented group this attribute returns a function <code class="code">smaller(<var class="Arg">left</var>, <var class="Arg">right</var>)</code> that will be used to compare elements in <var class="Arg">fam</var>.</p>

<p><a id="X82CB9EC982CDAEAC" name="X82CB9EC982CDAEAC"></a></p>

<h5>47.3-4 SetReducedMultiplication</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SetReducedMultiplication</code>( <var class="Arg">obj</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>For an FpGroup <var class="Arg">obj</var>, an element <var class="Arg">obj</var> of it or the family <var class="Arg">obj</var> of its elements, this function will force immediate reduction when multiplying, keeping words short at extra cost per multiplication.</p>

<p><a id="X7B0B2781796800AD" name="X7B0B2781796800AD"></a></p>

<h4>47.4 <span class="Heading">Preimages in the Free Group</span></h4>

<p><a id="X85CF3931849FB441" name="X85CF3931849FB441"></a></p>

<h5>47.4-1 FreeGroupOfFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FreeGroupOfFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>returns the underlying free group for the finitely presented group <var class="Arg">G</var>. This is the group generated by the free generators provided by the <code class="func">FreeGeneratorsOfFpGroup</code> (<a href="chap47_mj.html#X79C77C5184CA02B6"><span class="RefLink">47.4-2</span></a>) value of <var class="Arg">G</var>.</p>

<p><a id="X79C77C5184CA02B6" name="X79C77C5184CA02B6"></a></p>

<h5>47.4-2 FreeGeneratorsOfFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FreeGeneratorsOfFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FreeGeneratorsOfWholeGroup</code>( <var class="Arg">U</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p><code class="func">FreeGeneratorsOfFpGroup</code> returns the underlying free generators corresponding to the generators of the finitely presented group <var class="Arg">G</var> which must be a full FpGroup.</p>

<p><code class="func">FreeGeneratorsOfWholeGroup</code> also works for subgroups of an FpGroup and returns the free generators of the full group that defines the family.</p>

<p><a id="X87BA180287CD1F71" name="X87BA180287CD1F71"></a></p>

<h5>47.4-3 RelatorsOfFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RelatorsOfFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>returns the relators of the finitely presented group <var class="Arg">G</var> as words in the free generators provided by the <code class="func">FreeGeneratorsOfFpGroup</code> (<a href="chap47_mj.html#X79C77C5184CA02B6"><span class="RefLink">47.4-2</span></a>) value of <var class="Arg">G</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( "a", "b" );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g := f / [ f.1^5, f.2^2, f.1^f.2*f.1 ];</span>
&lt;fp group on the generators [ a, b ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size( g );</span>
10
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">FreeGroupOfFpGroup( g ) = f;</span>
true
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">FreeGeneratorsOfFpGroup( g );</span>
[ a, b ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RelatorsOfFpGroup( g );</span>
[ a^5, b^2, b^-1*a*b*a ]
</pre></div>

<p>Note that these attributes are only available for the <em>full</em> finitely presented group. It is possible (for example by using <code class="func">Subgroup</code> (<a href="chap39_mj.html#X7C82AA387A42DCA0"><span class="RefLink">39.3-1</span></a>)) to construct a subgroup of index <span class="SimpleMath">\(1\)</span> which is not identical to the whole group. The latter one can be obtained in this situation via <code class="func">Parent</code> (<a href="chap31_mj.html#X7BC856CC7F116BB0"><span class="RefLink">31.7-1</span></a>).</p>

<p>Elements of a finitely presented group are not words, but are represented using a word from the free group as representative. The following two commands obtain this representative, respectively create an element in the finitely presented group.</p>

<p><a id="X8447A2397A1E524B" name="X8447A2397A1E524B"></a></p>

<h5>47.4-4 UnderlyingElement</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; UnderlyingElement</code>( <var class="Arg">elm</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>Let <var class="Arg">elm</var> be an element of a group whose elements are represented as words with further properties. Then <code class="func">UnderlyingElement</code> returns the word from the free group that is used as a representative for <var class="Arg">elm</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">w := g.1*g.2;</span>
a*b
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsWord( w );</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ue := UnderlyingElement( w );</span>
a*b
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsWord( ue );</span>
true
</pre></div>

<p><a id="X7F34C8017DC03FDB" name="X7F34C8017DC03FDB"></a></p>

<h5>47.4-5 ElementOfFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; ElementOfFpGroup</code>( <var class="Arg">fam</var>, <var class="Arg">word</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>If <var class="Arg">fam</var> is the elements family of a finitely presented group and <var class="Arg">word</var> is a word in the free generators underlying this finitely presented group, this operation creates the element with the representative <var class="Arg">word</var> in the free group.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ge := ElementOfFpGroup( FamilyObj( g.1 ), f.1*f.2 );</span>
a*b
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ge in f;</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ge in g;</span>
true
</pre></div>

<p><a id="X869143D284F3379D" name="X869143D284F3379D"></a></p>

<h4>47.5 <span class="Heading">Operations for Finitely Presented Groups</span></h4>

<p>Finitely presented groups are groups and so all operations for groups should be applicable to them (though not necessarily efficient methods are available). Most methods for finitely presented groups rely on coset enumeration. See <a href="chap47_mj.html#X7BD0CEBA7B225416"><span class="RefLink">47.6</span></a> for details.</p>

<p>The command <code class="func">IsomorphismPermGroup</code> (<a href="chap43_mj.html#X80B7B1C783AA1567"><span class="RefLink">43.3-1</span></a>) can be used to obtain a faithful permutation representation, if such a representation of small degree exists. (Otherwise it might run very long or fail.)</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( "a", "b" );</span>
&lt;free group on the generators [ a, b ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g := f / [ f.1^2, f.2^3, (f.1*f.2)^5 ];</span>
&lt;fp group on the generators [ a, b ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">h := IsomorphismPermGroup( g );</span>
[ a, b ] -&gt; [ (1,2)(3,5), (2,3,4) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">u:=Subgroup(g,[g.1*g.2]);;rt:=RightTransversal(g,u);</span>
RightTransversal(&lt;fp group of size 60 on the generators 
[ a, b ]&gt;,Group([ a*b ]))
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Image(ActionHomomorphism(g,rt,OnRight));</span>
Group([ (1,2)(3,4)(5,7)(6,8)(9,10)(11,12), 
  (1,3,2)(4,5,6)(7,8,9)(10,11,12) ])
</pre></div>

<p><a id="X7AB7187779EDC9BA" name="X7AB7187779EDC9BA"></a></p>

<h5>47.5-1 PseudoRandom</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; PseudoRandom</code>( <var class="Arg">F:</var> <var class="Arg">radius</var> <var class="Arg">:=</var> <var class="Arg">l</var> )</td><td class="tdright">(&nbsp;method&nbsp;)</td></tr></table></div>
<p>The default algorithm for <code class="func">PseudoRandom</code> (<a href="chap30_mj.html#X811B5BD47DC5356B"><span class="RefLink">30.7-2</span></a>) makes little sense for finitely presented or free groups, as it produces words that are extremely long.</p>

<p>By specifying the option <code class="code">radius</code>, instead elements are taken as words in the generators of <var class="Arg">F</var> in the ball of radius <var class="Arg">l</var> with equal distribution in the free group.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PseudoRandom(g:radius:=20);</span>
a^3*b^2*a^-2*b^-1*a*b^-4*a*b^-1*a*b^-4
</pre></div>

<p><a id="X7BD0CEBA7B225416" name="X7BD0CEBA7B225416"></a></p>

<h4>47.6 <span class="Heading">Coset Tables and Coset Enumeration</span></h4>

<p>Coset enumeration (see <a href="chapBib_mj.html#biBNeu82">[Neu82]</a> for an explanation) is one of the fundamental tools for the examination of finitely presented groups. This section describes <strong class="pkg">GAP</strong> functions that can be used to invoke a coset enumeration.</p>

<p>Note that in addition to the built-in coset enumerator there is the <strong class="pkg">GAP</strong> package <strong class="pkg">ACE</strong>. Moreover, <strong class="pkg">GAP</strong> provides an interactive Todd-Coxeter in the <strong class="pkg">GAP</strong> package <strong class="pkg">ITC</strong> which is based on the <strong class="pkg">XGAP</strong> package.</p>

<p><a id="X7F7F31E47D7F6EF8" name="X7F7F31E47D7F6EF8"></a></p>

<h5>47.6-1 CosetTable</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTable</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>returns the coset table of the finitely presented group <var class="Arg">G</var> on the cosets of the subgroup <var class="Arg">H</var>.</p>

<p>Basically a coset table is the permutation representation of the finitely presented group on the cosets of a subgroup (which need not be faithful if the subgroup has a nontrivial core). Most of the set theoretic and group functions use the regular representation of <var class="Arg">G</var>, i.e., the coset table of <var class="Arg">G</var> over the trivial subgroup.</p>

<p>The coset table is returned as a list of lists. For each generator of <var class="Arg">G</var> and its inverse the table contains a generator list. A generator list is simply a list of integers. If <span class="SimpleMath">\(l\)</span> is the generator list for the generator <span class="SimpleMath">\(g\)</span> and if <span class="SimpleMath">\(l[i] = j\)</span> then generator <span class="SimpleMath">\(g\)</span> takes the coset <span class="SimpleMath">\(i\)</span> to the coset <span class="SimpleMath">\(j\)</span> by multiplication from the right. Thus the permutation representation of <var class="Arg">G</var> on the cosets of <var class="Arg">H</var> is obtained by applying <code class="func">PermList</code> (<a href="chap42_mj.html#X78D611D17EA6E3BC"><span class="RefLink">42.5-2</span></a>) to each generator list.</p>

<p>The coset table is standard (see below).</p>

<p>For finitely presented groups, a coset table is computed by a Todd-Coxeter coset enumeration. Note that you may influence the performance of that enumeration by changing the values of the global variables <code class="func">CosetTableDefaultLimit</code> (<a href="chap47_mj.html#X7A80A00E7E088E44"><span class="RefLink">47.6-7</span></a>) and <code class="func">CosetTableDefaultMaxLimit</code> (<a href="chap47_mj.html#X822B188F87E9E642"><span class="RefLink">47.6-6</span></a>) described below and that the options described under <code class="func">CosetTableFromGensAndRels</code> (<a href="chap47_mj.html#X7DE601F179E6FD09"><span class="RefLink">47.6-5</span></a>) are recognized.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">tab := CosetTable(g, Subgroup(g, [ g.1, g.2*g.1*g.2*g.1*g.2^-1 ]));</span>
[ [ 1, 4, 5, 2, 3 ], [ 1, 4, 5, 2, 3 ], [ 2, 3, 1, 4, 5 ], 
  [ 3, 1, 2, 4, 5 ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List( last, PermList );</span>
[ (2,4)(3,5), (2,4)(3,5), (1,2,3), (1,3,2) ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PrintArray( TransposedMat( tab ) );</span>
[ [  1,  1,  2,  3 ],
  [  4,  4,  3,  1 ],
  [  5,  5,  1,  2 ],
  [  2,  2,  4,  4 ],
  [  3,  3,  5,  5 ] ]
</pre></div>

<p>The last printout in the preceding example provides the coset table in the form in which it is usually used in hand calculations: The rows correspond to the cosets, the columns correspond to the generators and their inverses in the ordering <span class="SimpleMath">\(g_1, g_1^{{-1}}, g_2, g_2^{{-1}}\)</span>. (See section <a href="chap47_mj.html#X85B882F782D7AFD0"><span class="RefLink">47.7</span></a> for a description on the way the numbers are assigned.)</p>

<p><a id="X87D175757C581E62" name="X87D175757C581E62"></a></p>

<h5>47.6-2 TracedCosetFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; TracedCosetFpGroup</code>( <var class="Arg">tab</var>, <var class="Arg">word</var>, <var class="Arg">pt</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Traces the coset number <var class="Arg">pt</var> under the word <var class="Arg">word</var> through the coset table <var class="Arg">tab</var>. (Note: <var class="Arg">word</var> must be in the free group, use <code class="func">UnderlyingElement</code> (<a href="chap47_mj.html#X8447A2397A1E524B"><span class="RefLink">47.4-4</span></a>) if in doubt.)</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">TracedCosetFpGroup(tab,UnderlyingElement(g.1),2);</span>
4
</pre></div>

<p><a id="X7EC1B0EE876E478A" name="X7EC1B0EE876E478A"></a></p>

<h5>47.6-3 FactorCosetAction</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; FactorCosetAction</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>returns the action of <var class="Arg">G</var> on the cosets of its subgroup <var class="Arg">H</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">u := Subgroup( g, [ g.1, g.1^g.2 ] );</span>
Group([ a, b^-1*a*b ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">FactorCosetAction( g, u );</span>
[ a, b ] -&gt; [ (2,4)(5,6), (1,2,3)(4,5,6) ]
</pre></div>

<p><a id="X82926A7F8365A341" name="X82926A7F8365A341"></a></p>

<h5>47.6-4 CosetTableBySubgroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableBySubgroup</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>returns a coset table for the action of <var class="Arg">G</var> on the cosets of <var class="Arg">H</var>. The columns of the table correspond to the <code class="func">GeneratorsOfGroup</code> (<a href="chap39_mj.html#X79C44528864044C5"><span class="RefLink">39.2-4</span></a>) value of <var class="Arg">G</var>.</p>

<p><a id="X7DE601F179E6FD09" name="X7DE601F179E6FD09"></a></p>

<h5>47.6-5 CosetTableFromGensAndRels</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableFromGensAndRels</code>( <var class="Arg">fgens</var>, <var class="Arg">grels</var>, <var class="Arg">fsgens</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>is an internal function which is called by the functions <code class="func">CosetTable</code> (<a href="chap47_mj.html#X7F7F31E47D7F6EF8"><span class="RefLink">47.6-1</span></a>), <code class="func">CosetTableInWholeGroup</code> (<a href="chap47_mj.html#X846EC8AB7803114D"><span class="RefLink">47.8-1</span></a>) and others. It is, in fact, the proper working horse that performs a Todd-Coxeter coset enumeration. <var class="Arg">fgens</var> must be a set of free generators and <var class="Arg">grels</var> a set of relators in these generators. <var class="Arg">fsgens</var> are subgroup generators expressed as words in these generators. The function returns a coset table with respect to <var class="Arg">fgens</var>.</p>

<p><code class="func">CosetTableFromGensAndRels</code> will call <code class="code">TCENUM.CosetTableFromGensAndRels</code>. This makes it possible to replace the built-in coset enumerator with another one by assigning <code class="code">TCENUM</code> to another record.</p>

<p>The library version which is used by default performs a standard Felsch strategy coset enumeration. You can call this function explicitly as <code class="code">GAPTCENUM.CosetTableFromGensAndRels</code> even if other coset enumerators are installed.</p>

<p>The expected parameters are</p>


<dl>
<dt><strong class="Mark"><var class="Arg">fgens</var></strong></dt>
<dd><p>generators of the free group <var class="Arg">F</var></p>

</dd>
<dt><strong class="Mark"><var class="Arg">grels</var></strong></dt>
<dd><p>relators as words in <var class="Arg">F</var></p>

</dd>
<dt><strong class="Mark"><var class="Arg">fsgens</var></strong></dt>
<dd><p>subgroup generators as words in <var class="Arg">F</var>.</p>

</dd>
</dl>
<p><code class="func">CosetTableFromGensAndRels</code> processes two options (see chapter <a href="chap8_mj.html#X7FD84061873F72A2"><span class="RefLink">8</span></a>):</p>


<dl>
<dt><strong class="Mark"><code class="code">max</code></strong></dt>
<dd><p>The limit of the number of cosets to be defined. If the enumeration does not finish with this number of cosets, an error is raised and the user is asked whether she wants to continue. The default value is the value given in the variable <code class="code">CosetTableDefaultMaxLimit</code>. (Due to the algorithm the actual limit used can be a bit higher than the number given.)</p>

</dd>
<dt><strong class="Mark"><code class="code">silent</code></strong></dt>
<dd><p>If set to <code class="keyw">true</code> the algorithm will not raise the error mentioned under option <code class="code">max</code> but silently return <code class="keyw">fail</code>. This can be useful if an enumeration is only wanted unless it becomes too big.</p>

</dd>
</dl>
<p><a id="X822B188F87E9E642" name="X822B188F87E9E642"></a></p>

<h5>47.6-6 CosetTableDefaultMaxLimit</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableDefaultMaxLimit</code></td><td class="tdright">(&nbsp;global variable&nbsp;)</td></tr></table></div>
<p>is the default limit for the number of cosets allowed in a coset enumeration.</p>

<p>A coset enumeration will not finish if the subgroup does not have finite index, and even if it has it may take many more intermediate cosets than the actual index of the subgroup is. To avoid a coset enumeration "running away" therefore <strong class="pkg">GAP</strong> has a "safety stop" built in. This is controlled by the global variable <code class="func">CosetTableDefaultMaxLimit</code>.</p>

<p>If this number of cosets is reached, <strong class="pkg">GAP</strong> will issue an error message and prompt the user to either continue the calculation or to stop it. The default value is <span class="SimpleMath">\(4096000\)</span>.</p>

<p>See also the description of the options to <code class="func">CosetTableFromGensAndRels</code> (<a href="chap47_mj.html#X7DE601F179E6FD09"><span class="RefLink">47.6-5</span></a>).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( "a", "b" );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">u := Subgroup( f, [ f.2 ] );</span>
Group([ b ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Index( f, u );</span>
Error, the coset enumeration has defined more than 4096000 cosets
 called from
TCENUM.CosetTableFromGensAndRels( fgens, grels, fsgens ) called from
CosetTableFromGensAndRels( fgens, grels, fsgens ) called from
TryCosetTableInWholeGroup( H ) called from
CosetTableInWholeGroup( H ) called from
IndexInWholeGroup( H ) called from
...
Entering break read-eval-print loop ...
type 'return;' if you want to continue with a new limit of 8192000 cosets,
type 'quit;' if you want to quit the coset enumeration,
type 'maxlimit := 0; return;' in order to continue without a limit
<span class="GAPbrkprompt">brk&gt;</span> <span class="GAPinput">quit;</span>
</pre></div>

<p>At this point, a <code class="keyw">break</code>-loop (see Section <a href="chap6_mj.html#X8593B49F8705B486"><span class="RefLink">6.4</span></a>) has been entered. The line beginning <code class="code">Error</code> tells you why this occurred. The next seven lines occur if <code class="func">OnBreak</code> (<a href="chap6_mj.html#X82EBF01181C3C859"><span class="RefLink">6.4-3</span></a>) has its default value <code class="func">Where</code> (<a href="chap6_mj.html#X7A7FFA2B7C1EF5A3"><span class="RefLink">6.4-5</span></a>). They explain, in this case, how <strong class="pkg">GAP</strong> came to be doing a coset enumeration. Then you are given a number of options of how to escape the <code class="keyw">break</code>-loop: you can either continue the calculation with a larger number of permitted cosets, stop the calculation if you don't expect the enumeration to finish (like in the example above), or continue without a limit on the number of cosets. (Choosing the first option will, of course, land you back in a <code class="keyw">break</code>-loop. Try it!)</p>

<p>Setting <code class="func">CosetTableDefaultMaxLimit</code> (or the <code class="code">max</code> option value, for any function that invokes a coset enumeration) to <code class="func">infinity</code> (<a href="chap18_mj.html#X8511B8DF83324C27"><span class="RefLink">18.2-1</span></a>) (or to <span class="SimpleMath">\(0\)</span>) will force all coset enumerations to continue until they either get a result or exhaust the whole available space. For example, each of the following two inputs</p>


<div class="example"><pre>
gap&gt; CosetTableDefaultMaxLimit := 0;;
gap&gt; Index( f, u );
</pre></div>

<p>or</p>


<div class="example"><pre>
gap&gt; Index( f, u : max := 0 );
</pre></div>

<p>have essentially the same effect as choosing the third option (typing: <code class="code">maxlimit := 0; return;</code>) at the <code class="code">brk&gt;</code> prompt above (instead of <code class="code">quit;</code>).</p>

<p><a id="X7A80A00E7E088E44" name="X7A80A00E7E088E44"></a></p>

<h5>47.6-7 CosetTableDefaultLimit</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableDefaultLimit</code></td><td class="tdright">(&nbsp;global variable&nbsp;)</td></tr></table></div>
<p>is the default number of cosets with which any coset table is initialized before doing a coset enumeration.</p>

<p>The function performing this coset enumeration will automatically extend the table whenever necessary (as long as the number of cosets does not exceed the value of <code class="func">CosetTableDefaultMaxLimit</code> (<a href="chap47_mj.html#X822B188F87E9E642"><span class="RefLink">47.6-6</span></a>)), but this is an expensive operation. Thus, if you change the value of <code class="func">CosetTableDefaultLimit</code>, you should set it to a number of cosets that you expect to be sufficient for your subsequent coset enumerations. On the other hand, if you make it too large, your job will unnecessarily waste a lot of space.</p>

<p>The default value of <code class="func">CosetTableDefaultLimit</code> is <span class="SimpleMath">\(1000\)</span>.</p>

<p><a id="X829D31A981CB2AF4" name="X829D31A981CB2AF4"></a></p>

<h5>47.6-8 MostFrequentGeneratorFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; MostFrequentGeneratorFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>is an internal function which is used in some applications of coset table methods. It returns the first of those generators of the given finitely presented group <var class="Arg">G</var> which occur most frequently in the relators.</p>

<p><a id="X7912E6577B577A5C" name="X7912E6577B577A5C"></a></p>

<h5>47.6-9 IndicesInvolutaryGenerators</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IndicesInvolutaryGenerators</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>returns the indices of those generators of the finitely presented group <var class="Arg">G</var> which are known to be involutions. This knowledge is used by internal functions to improve the performance of coset enumerations.</p>

<p><a id="X85B882F782D7AFD0" name="X85B882F782D7AFD0"></a></p>

<h4>47.7 <span class="Heading">Standardization of coset tables</span></h4>

<p>For any two coset numbers <span class="SimpleMath">\(i\)</span> and <span class="SimpleMath">\(j\)</span> with <span class="SimpleMath">\(i &lt; j\)</span> the first occurrence of <span class="SimpleMath">\(i\)</span> in a coset table precedes the first occurrence of <span class="SimpleMath">\(j\)</span> with respect to the usual row-wise ordering of the table entries. Following the notation of Charles Sims' book on computation with finitely presented groups <a href="chapBib_mj.html#biBSims94">[Sim94]</a> we call such a table a <em>standard coset table</em>.</p>

<p>The table entries which contain the first occurrences of the coset numbers <span class="SimpleMath">\(i &gt; 1\)</span> recursively provide for each <span class="SimpleMath">\(i\)</span> a representative of the corresponding coset in form of a unique word <span class="SimpleMath">\(w_i\)</span> in the generators and inverse generators of <span class="SimpleMath">\(G\)</span>. The first coset (which is <span class="SimpleMath">\(H\)</span> itself) can be represented by the empty word <span class="SimpleMath">\(w_1\)</span>. A coset table is standard if and only if the words <span class="SimpleMath">\(w_1, w_2, \ldots\)</span> are length-plus-lexicographic ordered (as defined in <a href="chapBib_mj.html#biBSims94">[Sim94]</a>), for short: <em>lenlex</em>.</p>

<p>This standardization of coset tables is different from that used in <strong class="pkg">GAP</strong> versions 4.2 and earlier. Before that, we ignored the columns that correspond to inverse generators and hence only considered words in the generators of <span class="SimpleMath">\(G\)</span>. We call this older ordering the <em>semilenlex</em> standard as it also applies to the case of semigroups where no inverses of the generators are known.</p>

<p>We changed our default from the semilenlex standard to the lenlex standard to be consistent with <a href="chapBib_mj.html#biBSims94">[Sim94]</a>. However, the semilenlex standardisation remains available and the convention used for all implicit standardisations can be selected by setting the value of the global variable <code class="func">CosetTableStandard</code> (<a href="chap47_mj.html#X85FD1D637EF1EBE7"><span class="RefLink">47.7-1</span></a>) to either <code class="code">"lenlex"</code> or <code class="code">"semilenlex"</code>. Independent of the current value of <code class="func">CosetTableStandard</code> (<a href="chap47_mj.html#X85FD1D637EF1EBE7"><span class="RefLink">47.7-1</span></a>) you can standardize (or restandardize) a coset table at any time using <code class="func">StandardizeTable</code> (<a href="chap47_mj.html#X85FCD8DF81BA94D5"><span class="RefLink">47.7-2</span></a>).</p>

<p><a id="X85FD1D637EF1EBE7" name="X85FD1D637EF1EBE7"></a></p>

<h5>47.7-1 CosetTableStandard</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableStandard</code></td><td class="tdright">(&nbsp;global variable&nbsp;)</td></tr></table></div>
<p>specifies the definition of a <em>standard coset table</em>. It is used whenever coset tables or augmented coset tables are created. Its value may be <code class="code">"lenlex"</code> or <code class="code">"semilenlex"</code>. If it is <code class="code">"lenlex"</code> coset tables will be standardized using all their columns as defined in Charles Sims' book (this is the new default standard of <strong class="pkg">GAP</strong>). If it is <code class="code">"semilenlex"</code> they will be standardized using only their generator columns (this was the original <strong class="pkg">GAP</strong> standard). The default value of <code class="func">CosetTableStandard</code> is <code class="code">"lenlex"</code>.</p>

<p><a id="X85FCD8DF81BA94D5" name="X85FCD8DF81BA94D5"></a></p>

<h5>47.7-2 StandardizeTable</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; StandardizeTable</code>( <var class="Arg">table</var>, <var class="Arg">standard</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>standardizes the given coset table <var class="Arg">table</var>. The second argument is optional. It defines the standard to be used, its values may be <code class="code">"lenlex"</code> or <code class="code">"semilenlex"</code> specifying the new or the old convention, respectively. If no value for the parameter <var class="Arg">standard</var> is provided the function will use the global variable <code class="func">CosetTableStandard</code> (<a href="chap47_mj.html#X85FD1D637EF1EBE7"><span class="RefLink">47.7-1</span></a>) instead. Note that the function alters the given table, it does not create a copy.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">StandardizeTable( tab, "semilenlex" );</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PrintArray( TransposedMat( tab ) );</span>
[ [  1,  1,  2,  4 ],
  [  3,  3,  4,  1 ],
  [  2,  2,  3,  3 ],
  [  5,  5,  1,  2 ],
  [  4,  4,  5,  5 ] ]
</pre></div>

<p><a id="X87C3FA0784A85309" name="X87C3FA0784A85309"></a></p>

<h4>47.8 <span class="Heading">Coset tables for subgroups in the whole group</span></h4>

<p><a id="X846EC8AB7803114D" name="X846EC8AB7803114D"></a></p>

<h5>47.8-1 CosetTableInWholeGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CosetTableInWholeGroup</code>( <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; TryCosetTableInWholeGroup</code>( <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>is equivalent to <code class="code">CosetTable(<var class="Arg">G</var>,<var class="Arg">H</var>)</code> where <var class="Arg">G</var> is the (unique) finitely presented group such that <var class="Arg">H</var> is a subgroup of <var class="Arg">G</var>. It overrides a <code class="code">silent</code> option (see <code class="func">CosetTableFromGensAndRels</code> (<a href="chap47_mj.html#X7DE601F179E6FD09"><span class="RefLink">47.6-5</span></a>)) with <code class="keyw">false</code>.</p>

<p>The variant <code class="func">TryCosetTableInWholeGroup</code> does not override the <code class="code">silent</code> option with <code class="keyw">false</code> in case a coset table is only wanted if not too expensive. It will store a result that is not <code class="keyw">fail</code> in the attribute <code class="func">CosetTableInWholeGroup</code>.</p>

<p><a id="X857F239583AFE0B7" name="X857F239583AFE0B7"></a></p>

<h5>47.8-2 SubgroupOfWholeGroupByCosetTable</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SubgroupOfWholeGroupByCosetTable</code>( <var class="Arg">fpfam</var>, <var class="Arg">tab</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>takes a family <var class="Arg">fpfam</var> of an FpGroup and a standardized coset table <var class="Arg">tab</var> and returns the subgroup of <var class="Arg">fpfam</var><code class="code">!.wholeGroup</code> defined by this coset table. The function will not check whether the coset table is standardized. See also <code class="func">CosetTableBySubgroup</code> (<a href="chap47_mj.html#X82926A7F8365A341"><span class="RefLink">47.6-4</span></a>).</p>

<p><a id="X7E17A14E823F953D" name="X7E17A14E823F953D"></a></p>

<h4>47.9 <span class="Heading">Augmented Coset Tables and Rewriting</span></h4>

<p><a id="X80F8BF1D867DA7C1" name="X80F8BF1D867DA7C1"></a></p>

<h5>47.9-1 AugmentedCosetTableInWholeGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AugmentedCosetTableInWholeGroup</code>( <var class="Arg">H</var>[, <var class="Arg">gens</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>For a subgroup <var class="Arg">H</var> of a finitely presented group, this function returns an augmented coset table. If a generator set <var class="Arg">gens</var> is given, it is guaranteed that <var class="Arg">gens</var> will be a subset of the primary and secondary subgroup generators of this coset table.</p>

<p>It is mutable so we are permitted to add further entries. However existing entries may not be changed. Any entries added however should correspond to the subgroup only and not to a homomorphism.</p>

<p><a id="X7AF67CFD846C1159" name="X7AF67CFD846C1159"></a></p>

<h5>47.9-2 AugmentedCosetTableMtc</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AugmentedCosetTableMtc</code>( <var class="Arg">G</var>, <var class="Arg">H</var>, <var class="Arg">type</var>, <var class="Arg">string</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>is an internal function used by the subgroup presentation functions described in <a href="chap48_mj.html#X8118FECE7AD1879B"><span class="RefLink">48.2</span></a>. It applies a Modified Todd-Coxeter coset representative enumeration to construct an augmented coset table (see <a href="chap48_mj.html#X8118FECE7AD1879B"><span class="RefLink">48.2</span></a>) for the given subgroup <var class="Arg">H</var> of <var class="Arg">G</var>. The subgroup generators will be named <var class="Arg">string</var><code class="code">1</code>, <var class="Arg">string</var><code class="code">2</code>, <span class="SimpleMath">\(\ldots\)</span>.</p>

<p>The function accepts the options <code class="code">max</code> and <code class="code">silent</code> as described for the function <code class="func">CosetTableFromGensAndRels</code> (<a href="chap47_mj.html#X7DE601F179E6FD09"><span class="RefLink">47.6-5</span></a>).</p>

<p><a id="X7F3F09C778552811" name="X7F3F09C778552811"></a></p>

<h5>47.9-3 AugmentedCosetTableRrs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AugmentedCosetTableRrs</code>( <var class="Arg">G</var>, <var class="Arg">table</var>, <var class="Arg">type</var>, <var class="Arg">string</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>is an internal function used by the subgroup presentation functions described in <a href="chap48_mj.html#X8118FECE7AD1879B"><span class="RefLink">48.2</span></a>. It applies the Reduced Reidemeister-Schreier method to construct an augmented coset table for the subgroup of <var class="Arg">G</var> which is defined by the given coset table <var class="Arg">table</var>. The new subgroup generators will be named <var class="Arg">string</var><code class="code">1</code>, <var class="Arg">string</var><code class="code">2</code>, <span class="SimpleMath">\(\ldots\)</span>.</p>

<p><a id="X86B65EA186140244" name="X86B65EA186140244"></a></p>

<h5>47.9-4 RewriteWord</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RewriteWord</code>( <var class="Arg">aug</var>, <var class="Arg">word</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p><code class="func">RewriteWord</code> rewrites <var class="Arg">word</var> (which must be a word in the underlying free group with respect to which the augmented coset table <var class="Arg">aug</var> is given) in the subgroup generators given by the augmented coset table <var class="Arg">aug</var>. It returns a Tietze-type word (i.e. a list of integers), referring to the primary and secondary generators of <var class="Arg">aug</var>.</p>

<p>If <var class="Arg">word</var> is not contained in the subgroup, <code class="keyw">fail</code> is returned.</p>

<p><a id="X87FBDA2B815A8776" name="X87FBDA2B815A8776"></a></p>

<h4>47.10 <span class="Heading">Low Index Subgroups</span></h4>

<p><a id="X85C5151380E19122" name="X85C5151380E19122"></a></p>

<h5>47.10-1 LowIndexSubgroupsFpGroupIterator</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LowIndexSubgroupsFpGroupIterator</code>( <var class="Arg">G</var>[, <var class="Arg">H</var>], <var class="Arg">index</var>[, <var class="Arg">excluded</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LowIndexSubgroupsFpGroup</code>( <var class="Arg">G</var>[, <var class="Arg">H</var>], <var class="Arg">index</var>[, <var class="Arg">excluded</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>These functions compute representatives of the conjugacy classes of subgroups of the finitely presented group <var class="Arg">G</var> that contain the subgroup <var class="Arg">H</var> of <var class="Arg">G</var> and that have index less than or equal to <var class="Arg">index</var>.</p>

<p><code class="func">LowIndexSubgroupsFpGroupIterator</code> returns an iterator (see <a href="chap30_mj.html#X85A3F00985453F95"><span class="RefLink">30.8</span></a>) that can be used to run over these subgroups, and <code class="func">LowIndexSubgroupsFpGroup</code> returns the list of these subgroups. If one is interested only in one or a few subgroups up to a given index then preferably the iterator should be used.</p>

<p>If the optional argument <var class="Arg">excluded</var> has been specified, then it is expected to be a list of words in the free generators of the underlying free group of <var class="Arg">G</var>, and <code class="func">LowIndexSubgroupsFpGroup</code> returns only those subgroups of index at most <var class="Arg">index</var> that contain <var class="Arg">H</var>, but do not contain any conjugate of any of the group elements defined by these words.</p>

<p>If not given, <var class="Arg">H</var> defaults to the trivial subgroup.</p>

<p>The algorithm used finds the requested subgroups by systematically running through a tree of all potential coset tables of <var class="Arg">G</var> of length at most <var class="Arg">index</var> (where it skips all branches of that tree for which it knows in advance that they cannot provide new classes of such subgroups). The time required to do this depends, of course, on the presentation of <var class="Arg">G</var>, but in general it will grow exponentially with the value of <var class="Arg">index</var>. So you should be careful with the choice of <var class="Arg">index</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">li:=LowIndexSubgroupsFpGroup( g, TrivialSubgroup( g ), 10 );</span>
[ Group(&lt;fp, no generators known&gt;), Group(&lt;fp, no generators known&gt;), 
  Group(&lt;fp, no generators known&gt;), Group(&lt;fp, no generators known&gt;) ]
</pre></div>

<p>By default, the algorithm computes no generating sets for the subgroups. This can be enforced with <code class="func">GeneratorsOfGroup</code> (<a href="chap39_mj.html#X79C44528864044C5"><span class="RefLink">39.2-4</span></a>):</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GeneratorsOfGroup(li[2]);</span>
[ a, b*a*b^-1 ]
</pre></div>

<p>If we are interested just in one (proper) subgroup of index at most <span class="SimpleMath">\(10\)</span>, we can use the function that returns an iterator. The first subgroup found is the group itself, except if a list of excluded elements is entered (see below), so we look at the second subgroup.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iter:= LowIndexSubgroupsFpGroupIterator( g, 10 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">s1:= NextIterator( iter );;  Index( g, s1 );</span>
1
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">IsDoneIterator( iter );</span>
false
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">s2:= NextIterator( iter );;  s2 = li[2];</span>
true
</pre></div>

<p>As an example for an application of the optional parameter <var class="Arg">excluded</var>, we compute all conjugacy classes of torsion free subgroups of index at most <span class="SimpleMath">\(24\)</span> in the group <span class="SimpleMath">\(G = \langle x,y,z \mid x^2, y^4, z^3, (xy)^3, (yz)^2, (xz)^3 \rangle\)</span>. It is know from theory that each torsion element of this group is conjugate to a power of <span class="SimpleMath">\(x\)</span>, <span class="SimpleMath">\(y\)</span>, <span class="SimpleMath">\(z\)</span>, <span class="SimpleMath">\(xy\)</span>, <span class="SimpleMath">\(xz\)</span>, or <span class="SimpleMath">\(yz\)</span>. (Note that this includes conjugates of <span class="SimpleMath">\(y^2\)</span>.)</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">F := FreeGroup( "x", "y", "z" );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">x := F.1;; y := F.2;; z := F.3;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := F / [ x^2, y^4, z^3, (x*y)^3, (y*z)^2, (x*z)^3 ];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">torsion := [ x, y, y^2, z, x*y, x*z, y*z ];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">SetInfoLevel( InfoFpGroup, 2 );</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">lis := LowIndexSubgroupsFpGroup(G, TrivialSubgroup(G), 24, torsion);;</span>
#I  LowIndexSubgroupsFpGroup called
#I   class 1 of index 24 and length 8
#I   class 2 of index 24 and length 24
#I   class 3 of index 24 and length 24
#I   class 4 of index 24 and length 24
#I   class 5 of index 24 and length 24
#I  LowIndexSubgroupsFpGroup done. Found 5 classes
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">SetInfoLevel( InfoFpGroup, 0 );</span>
</pre></div>

<p>If a particular image group is desired, the operation <code class="func">GQuotients</code> (<a href="chap40_mj.html#X790C261184EEAB94"><span class="RefLink">40.9-4</span></a>) (see <a href="chap47_mj.html#X846072F779B51087"><span class="RefLink">47.14</span></a>) can be useful as well.</p>

<p><a id="X81003D217D92E342" name="X81003D217D92E342"></a></p>

<h4>47.11 <span class="Heading">Converting Groups to Finitely Presented Groups</span></h4>

<p><a id="X7F28268F850F454E" name="X7F28268F850F454E"></a></p>

<h5>47.11-1 IsomorphismFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>returns an isomorphism from the given finite group <var class="Arg">G</var> to a finitely presented group isomorphic to <var class="Arg">G</var>. The function first <em>chooses a set of generators of <var class="Arg">G</var></em> and then computes a presentation in terms of these generators.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g := Group( (2,3,4,5), (1,2,5) );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroup( g );</span>
[ (1,2), (2,3), (3,4), (4,5) ] -&gt; [ F1, F2, F3, F4 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">fp := Image( iso );</span>
&lt;fp group of size 120 on the generators [ F1, F2, F3, F4 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RelatorsOfFpGroup( fp );</span>
[ F1^2, F2^2, F3^2, F4^2, (F1*F2)^3, (F1*F3)^2, (F1*F4)^2, (F2*F3)^3,
  (F2*F4)^2, (F3*F4)^3 ]
</pre></div>

<p><a id="X81B2B3B6812FD62D" name="X81B2B3B6812FD62D"></a></p>

<h5>47.11-2 IsomorphismFpGroupByGenerators</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismFpGroupByGenerators</code>( <var class="Arg">G</var>, <var class="Arg">gens</var>[, <var class="Arg">string</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismFpGroupByGeneratorsNC</code>( <var class="Arg">G</var>, <var class="Arg">gens</var>, <var class="Arg">string</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>returns an isomorphism from a finite group <var class="Arg">G</var> to a finitely presented group <var class="Arg">F</var> isomorphic to <var class="Arg">G</var>. The generators of <var class="Arg">F</var> correspond to the <em>generators of <var class="Arg">G</var> given in the list <var class="Arg">gens</var></em>. If <var class="Arg">string</var> is given it is used to name the generators of the finitely presented group.</p>

<p>The <code class="code">NC</code> version will avoid testing whether the elements in <var class="Arg">gens</var> generate <var class="Arg">G</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">SetInfoLevel( InfoFpGroup, 1 );</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( g, [ (1,2), (1,2,3,4,5) ] );</span>
#I  the image group has 2 gens and 5 rels of total length 39
[ (1,2), (1,2,3,4,5) ] -&gt; [ F1, F2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">fp := Image( iso );</span>
&lt;fp group of size 120 on the generators [ F1, F2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RelatorsOfFpGroup( fp );</span>
[ F1^2, F2^5, (F2^-1*F1)^4, (F1*F2*F1*F2^-1)^3, (F2*F1*F2^-2*F1*F2)^2
 ]
</pre></div>

<p>The main task of the function <code class="func">IsomorphismFpGroupByGenerators</code> is to find a presentation of <var class="Arg">G</var> in the provided generators <var class="Arg">gens</var>. In the case of a permutation group <var class="Arg">G</var> it does this by first constructing a stabilizer chain of <var class="Arg">G</var> and then it works through that chain from the bottom to the top, recursively computing a presentation for each of the involved stabilizers. The method used is essentially an implementation of John Cannon's multi-stage relations-finding algorithm as described in <a href="chapBib_mj.html#biBNeu82">[Neu82]</a> (see also <a href="chapBib_mj.html#biBCan73">[Can73]</a> for a more graph theoretical description). Moreover, it makes heavy use of Tietze transformations in each stage to avoid an explosion of the total length of the relators.</p>

<p>Note that because of the random methods involved in the construction of the stabilizer chain the resulting presentations of <var class="Arg">G</var> will in general be different for repeated calls with the same arguments.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">M12 := MathieuGroup( 12 );</span>
Group([ (1,2,3,4,5,6,7,8,9,10,11), (3,7,11,8)(4,10,5,6), 
  (1,12)(2,11)(3,6)(4,8)(5,9)(7,10) ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gens := GeneratorsOfGroup( M12 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( M12, gens );;</span>
#I  the image group has 3 gens and 20 rels of total length 418
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( M12, gens );;</span>
#I  the image group has 3 gens and 20 rels of total length 526
</pre></div>

<p>Also in the case of a permutation group <var class="Arg">G</var>, the function <code class="func">IsomorphismFpGroupByGenerators</code> supports the option <code class="code">method</code> that can be used to modify the strategy. The option <code class="code">method</code> may take the following values.</p>


<dl>
<dt><strong class="Mark"><code class="code">method := "regular"</code></strong></dt>
<dd><p>This may be specified for groups of small size, up to <span class="SimpleMath">\(10^5\)</span> say. It implies that the function first constructs a regular representation <var class="Arg">R</var> of <var class="Arg">G</var> and then a presentation of <var class="Arg">R</var>. In general, this presentation will be much more concise than the default one, but the price is the time needed for the construction of <var class="Arg">R</var>.</p>

</dd>
<dt><strong class="Mark"><code class="code">method := [ "regular", bound ]</code></strong></dt>
<dd><p>This is a refinement of the previous possibility. In this case, <code class="code">bound</code> should be an integer, and if so the method <code class="code">"regular"</code> as described above is applied to the largest stabilizer in the stabilizer chain of <var class="Arg">G</var> whose size does not exceed the given bound and then the multi-stage algorithm is used to work through the chain from that subgroup to the top.</p>

</dd>
<dt><strong class="Mark"><code class="code">method := "fast"</code></strong></dt>
<dd><p>This chooses an alternative method which essentially is a kind of multi-stage algorithm for a stabilizer chain of <var class="Arg">G</var> but does not make any attempt do reduce the number of relators as it is done in Cannon's algorithm or to reduce their total length. Hence it is often much faster than the default method, but the total length of the resulting presentation may be huge.</p>

</dd>
<dt><strong class="Mark"><code class="code">method := "default"</code></strong></dt>
<dd><p>This simply means that the default method shall be used, which is the case if the option <code class="code">method</code> is not given a value.</p>

</dd>
</dl>

<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( M12, gens : </span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">                                          method := "regular" );;</span>
#I  the image group has 3 gens and 11 rels of total length 92
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( M12, gens : </span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">                                          method := "fast" );;</span>
#I  the image group has 3 gens and 135 rels of total length 2938
</pre></div>

<p>Though the option <code class="code">method := "regular"</code> is only checked in the case of a permutation group it also affects the performance and the results of the function <code class="func">IsomorphismFpGroupByGenerators</code> for other groups, e. g. for matrix groups. This happens because, for these groups, the function first calls the function <code class="func">NiceMonomorphism</code> (<a href="chap40_mj.html#X7965086E82ABCF41"><span class="RefLink">40.5-2</span></a>) to get a bijective action homomorphism from <var class="Arg">G</var> to a suitable permutation group, <span class="SimpleMath">\(P\)</span> say, and then, recursively, calls itself for the group <span class="SimpleMath">\(P\)</span> so that now the option becomes relevant.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">G := ImfMatrixGroup( 5, 1, 3 );</span>
ImfMatrixGroup(5,1,3)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gens := GeneratorsOfGroup( G );</span>
[ [ [ -1, 0, 0, 0, 0 ], [ 0, 1, 0, 0, 0 ], [ 0, 0, 0, 1, 0 ], 
      [ -1, -1, -1, -1, 2 ], [ -1, 0, 0, 0, 1 ] ], 
  [ [ 0, 1, 0, 0, 0 ], [ 0, 0, 1, 0, 0 ], [ 0, 0, 0, 1, 0 ], 
      [ 1, 0, 0, 0, 0 ], [ 0, 0, 0, 0, 1 ] ] ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( G, gens );;</span>
#I  the image group has 2 gens and 10 rels of total length 118
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso := IsomorphismFpGroupByGenerators( G, gens : </span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">                                          method := "regular");;</span>
#I  the image group has 2 gens and 6 rels of total length 56
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">SetInfoLevel( InfoFpGroup, 0 );</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">iso;</span>
&lt;composed isomorphism:[ [ [ -1, 0, 0, 0, 0 ], [ 0, 1, 0, 0, 0 ], [ 0, \
0, 0, 1, 0 ], [ -1, -1, -1, -1, 2 ], [ -1, 0, 0, 0, 1 ] ], [ [ 0, 1, 0\
, 0, 0 ], [ 0, 0, 1, 0, 0 ], [ 0, 0, 0, 1, 0 ], [ 1, 0, 0, 0, 0 ], [ 0\
, 0, 0, 0, 1 ] ] ]-&gt;[ F1, F2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">ConstituentsCompositionMapping(iso);</span>
[ &lt;action isomorphism&gt;, 
  [ (2,3,4)(5,6)(8,9,10), (1,2,3,5)(6,7,8,9) ] -&gt; [ F1, F2 ] ]
</pre></div>

<p>Since <strong class="pkg">GAP</strong> cannot decompose elements of a matrix group into generators, the resulting isomorphism is stored as a composition of a (faithful) permutation action on vectors and a homomorphism from the permutation image to the finitely presented group. In such a situation the constituent mappings can be obtained via <code class="func">ConstituentsCompositionMapping</code> (<a href="chap32_mj.html#X87775B438008DCA5"><span class="RefLink">32.2-8</span></a>) as separate <strong class="pkg">GAP</strong> objects.</p>

<p><a id="X826604AA7F18BFA3" name="X826604AA7F18BFA3"></a></p>

<h4>47.12 <span class="Heading">New Presentations and Presentations for Subgroups</span></h4>

<p><code class="func">IsomorphismFpGroup</code> (<a href="chap47_mj.html#X7F28268F850F454E"><span class="RefLink">47.11-1</span></a>) is also used to compute a new finitely presented group that is isomorphic to the given subgroup of a finitely presented group. (This is typically the only method to compute with subgroups of a finitely presented group.)</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup(2);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=f/[f.1^2,f.2^3,(f.1*f.2)^5];</span>
&lt;fp group on the generators [ f1, f2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">u:=Subgroup(g,[g.1*g.2]);</span>
Group([ f1*f2 ])
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=IsomorphismFpGroup(u);</span>
[ &lt;[ [ 1, 1 ] ]|f2^-1*f1^-1&gt; ] -&gt; [ F1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">new:=Range(hom);</span>
&lt;fp group on the generators [ F1 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(GeneratorsOfGroup(new),i-&gt;PreImagesRepresentative(hom,i));</span>
[ &lt;[ [ 1, 1 ] ]|f2^-1*f1^-1&gt; ]
</pre></div>

<p>When working with such homomorphisms, some subgroup elements are expressed as extremely long words in the group generators. Therefore the underlying words of subgroup generators stored in the isomorphism (as obtained by <code class="func">MappingGeneratorsImages</code> (<a href="chap40_mj.html#X863805187A24B5E3"><span class="RefLink">40.10-2</span></a>) and displayed when <code class="func">View</code> (<a href="chap6_mj.html#X851902C583B84CDC"><span class="RefLink">6.3-3</span></a>)ing the homomorphism) as well as preimages under the homomorphism are stored in the form of straight line program elements (see <a href="chap37_mj.html#X8188799182D82A92"><span class="RefLink">37.9</span></a>). These will behave like ordinary words and no extra treatment should be necessary.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">r:=Range(hom).1^10;</span>
F1^10
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p:=PreImagesRepresentative(hom,r);</span>
&lt;[ [ 1, 10 ] ]|(f2^-1*f1^-1)^10&gt;
</pre></div>

<p>If desired, it also is possible to convert these underlying words using <code class="func">EvalStraightLineProgElm</code> (<a href="chap37_mj.html#X7BEAE8AC809B27DC"><span class="RefLink">37.9-4</span></a>):</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">r:=EvalStraightLineProgElm(UnderlyingElement(p));</span>
(f2^-1*f1^-1)^10
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">p:=ElementOfFpGroup(FamilyObj(p),r);</span>
(f2^-1*f1^-1)^10
</pre></div>

<p>(If you are only interested in a finitely presented group isomorphic to the given subgroup but not in the isomorphism, you may also use the functions <code class="func">PresentationViaCosetTable</code> (<a href="chap48_mj.html#X84E056C57AFEDEA8"><span class="RefLink">48.1-5</span></a>) and <code class="func">FpGroupPresentation</code> (<a href="chap48_mj.html#X7D6F40A87F24D3D6"><span class="RefLink">48.1-4</span></a>) (see <a href="chap48_mj.html#X867D00387957450F"><span class="RefLink">48.1</span></a>).)</p>

<p>Homomorphisms can also be used to obtain an isomorphic finitely presented group with a (hopefully) simpler presentation.</p>

<p><a id="X78D87FA68233C401" name="X78D87FA68233C401"></a></p>

<h5>47.12-1 IsomorphismSimplifiedFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsomorphismSimplifiedFpGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>applies Tietze transformations to a copy of the presentation of the given finitely presented group <var class="Arg">G</var> in order to reduce it with respect to the number of generators, the number of relators, and the relator lengths.</p>

<p>The operation returns an isomorphism with source <var class="Arg">G</var>, range a group <var class="Arg">H</var> isomorphic to <var class="Arg">G</var>, so that the presentation of <var class="Arg">H</var> has been simplified using Tietze transformations.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup(3);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=f/[f.1^2,f.2^3,(f.1*f.2)^5,f.1/f.3];</span>
&lt;fp group on the generators [ f1, f2, f3 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=IsomorphismSimplifiedFpGroup(g);</span>
[ f1, f2, f3 ] -&gt; [ f1, f2, f1 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Range(hom);</span>
&lt;fp group on the generators [ f1, f2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RelatorsOfFpGroup(Range(hom));</span>
[ f1^2, f2^3, (f1*f2)^5 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">RelatorsOfFpGroup(g);</span>
[ f1^2, f2^3, (f1*f2)^5, f1*f3^-1 ]
</pre></div>

<p><code class="func">IsomorphismSimplifiedFpGroup</code> uses Tietze transformations to simplify the presentation, see <a href="chap48_mj.html#X7E1F2658827FC228"><span class="RefLink">48.1-6</span></a>.</p>

<p><a id="X86E7CE077D82133D" name="X86E7CE077D82133D"></a></p>

<h4>47.13 <span class="Heading">Preimages under Homomorphisms from an FpGroup</span></h4>

<p>For some subgroups of a finitely presented group the number of subgroup generators increases with the index of the subgroup. However often these generators are not needed at all for further calculations, but what is needed is the action of the cosets of the subgroup. This gives the image of the subgroup in a finite quotient and this finite quotient can be used to calculate normalizers, closures, intersections and so forth <a href="chapBib_mj.html#biBHulpkeQuot">[Hul01]</a>.</p>

<p>The same applies for subgroups that are obtained as preimages under homomorphisms.</p>

<p><a id="X7ABC3C917D41A74B" name="X7ABC3C917D41A74B"></a></p>

<h5>47.13-1 SubgroupOfWholeGroupByQuotientSubgroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SubgroupOfWholeGroupByQuotientSubgroup</code>( <var class="Arg">fpfam</var>, <var class="Arg">Q</var>, <var class="Arg">U</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>takes a FpGroup family <var class="Arg">fpfam</var>, a finitely generated group <var class="Arg">Q</var> such that the fp generators of <var class="Arg">fpfam</var> can be mapped by an epimorphism <span class="SimpleMath">\(phi\)</span> onto the <code class="func">GeneratorsOfGroup</code> (<a href="chap39_mj.html#X79C44528864044C5"><span class="RefLink">39.2-4</span></a>) value of <var class="Arg">Q</var>, and a subgroup <var class="Arg">U</var> of <var class="Arg">Q</var>. It returns the subgroup of <var class="Arg">fpfam</var><code class="code">!.wholeGroup</code> which is the full preimage of <var class="Arg">U</var> under <span class="SimpleMath">\(phi\)</span>.</p>

<p><a id="X8047D7A37B27FEEA" name="X8047D7A37B27FEEA"></a></p>

<h5>47.13-2 IsSubgroupOfWholeGroupByQuotientRep</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsSubgroupOfWholeGroupByQuotientRep</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;representation&nbsp;)</td></tr></table></div>
<p>is the representation for subgroups of an FpGroup, given by a quotient subgroup. The components <var class="Arg">G</var><code class="code">!.quot</code> and <var class="Arg">G</var><code class="code">!.sub</code> hold quotient, respectively subgroup.</p>

<p><a id="X84E6CEA28611C112" name="X84E6CEA28611C112"></a></p>

<h5>47.13-3 AsSubgroupOfWholeGroupByQuotient</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AsSubgroupOfWholeGroupByQuotient</code>( <var class="Arg">U</var> )</td><td class="tdright">(&nbsp;attribute&nbsp;)</td></tr></table></div>
<p>returns the same subgroup in the representation <code class="func">AsSubgroupOfWholeGroupByQuotient</code>.</p>

<p>See also <code class="func">SubgroupOfWholeGroupByCosetTable</code> (<a href="chap47_mj.html#X857F239583AFE0B7"><span class="RefLink">47.8-2</span></a>) and <code class="func">CosetTableBySubgroup</code> (<a href="chap47_mj.html#X82926A7F8365A341"><span class="RefLink">47.6-4</span></a>).</p>

<p>This technique is used by <strong class="pkg">GAP</strong> for example to represent the derived subgroup, which is obtained from the quotient <span class="SimpleMath">\(G/G'\)</span>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup(2);;g:=f/[f.1^6,f.2^6,(f.1*f.2)^6];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">d:=DerivedSubgroup(g);</span>
Group(&lt;fp, no generators known&gt;)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Index(g,d);</span>
36
</pre></div>

<p><a id="X7DA1151D84289FC9" name="X7DA1151D84289FC9"></a></p>

<h5>47.13-4 DefiningQuotientHomomorphism</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; DefiningQuotientHomomorphism</code>( <var class="Arg">U</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>if <var class="Arg">U</var> is a subgroup in quotient representation (<code class="func">IsSubgroupOfWholeGroupByQuotientRep</code> (<a href="chap47_mj.html#X8047D7A37B27FEEA"><span class="RefLink">47.13-2</span></a>)), this function returns the defining homomorphism from the whole group to <var class="Arg">U</var><code class="code">!.quot</code>.</p>

<p><a id="X846072F779B51087" name="X846072F779B51087"></a></p>

<h4>47.14 <span class="Heading">Quotient Methods</span></h4>

<p>An important class of algorithms for finitely presented groups are the <em>quotient algorithms</em> which compute quotient groups of a given finitely presented group. There are algorithms for epimorphisms onto abelian groups, <span class="SimpleMath">\(p\)</span>-groups and solvable groups. (The "low index" algorithm –<code class="func">LowIndexSubgroupsFpGroup</code> (<a href="chap47_mj.html#X85C5151380E19122"><span class="RefLink">47.10-1</span></a>)– can be considered as well as an algorithm that produces permutation group quotients.)</p>

<p><code class="func">MaximalAbelianQuotient</code> (<a href="chap39_mj.html#X7BB93B9778C5A0B2"><span class="RefLink">39.18-4</span></a>), as defined for general groups, returns the largest abelian quotient of the given group.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup(2);;fp:=f/[f.1^6,f.2^6,(f.1*f.2)^12];</span>
&lt;fp group on the generators [ f1, f2 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=MaximalAbelianQuotient(fp);</span>
[ f1, f2 ] -&gt; [ f1, f3 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(Image(hom));</span>
36
</pre></div>

<p><a id="X7B5DDADC80F5796B" name="X7B5DDADC80F5796B"></a></p>

<h5>47.14-1 PQuotient</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; PQuotient</code>( <var class="Arg">F</var>, <var class="Arg">p</var>[, <var class="Arg">c</var>][, <var class="Arg">logord</var>][, <var class="Arg">ctype</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>computes a factor <var class="Arg">p</var>-group of a finitely presented group <var class="Arg">F</var> in form of a quotient system. The quotient system can be converted into an epimorphism from <var class="Arg">F</var> onto the <var class="Arg">p</var>-group computed by the function <code class="func">EpimorphismQuotientSystem</code> (<a href="chap47_mj.html#X86EB30A7867EEF16"><span class="RefLink">47.14-2</span></a>).</p>

<p>For a group <span class="SimpleMath">\(G\)</span> define the exponent-<span class="SimpleMath">\(p\)</span> central series of <span class="SimpleMath">\(G\)</span> inductively by <span class="SimpleMath">\({\cal P}_1(G) = G\)</span> and <span class="SimpleMath">\({\cal P}_{{i+1}}(G) = [{\cal P}_i(G),G]{\cal P}_{{i+1}}(G)^p\)</span>. The factor groups modulo the terms of the lower exponent-<span class="SimpleMath">\(p\)</span> central series are <span class="SimpleMath">\(p\)</span>-groups. The group <span class="SimpleMath">\(G\)</span> has <span class="SimpleMath">\(p\)</span>-class <span class="SimpleMath">\(c\)</span> if <span class="SimpleMath">\({\cal P}_c(G) \neq {\cal P}_{{c+1}}(G) = 1\)</span>.</p>

<p>The algorithm computes successive quotients modulo the terms of the exponent-<span class="SimpleMath">\(p\)</span> central series of <var class="Arg">F</var>. If the parameter <var class="Arg">c</var> is present, then the factor group modulo the <span class="SimpleMath">\((c+1)\)</span>-th term of the exponent-<span class="SimpleMath">\(p\)</span> central series of <var class="Arg">F</var> is returned. If <var class="Arg">c</var> is not present, then the algorithm attempts to compute the largest factor <var class="Arg">p</var>-group of <var class="Arg">F</var>. In case <var class="Arg">F</var> does not have a largest factor <var class="Arg">p</var>-group, the algorithm will not terminate.</p>

<p>By default the algorithm computes only with factor groups of order at most <span class="SimpleMath">\(p^{256}\)</span>. If the parameter <var class="Arg">logord</var> is present, it will compute with factor groups of order at most <span class="SimpleMath">\(p^{\textit{logord}}\)</span>. If this parameter is specified, then the parameter <var class="Arg">c</var> must also be given. The present implementation produces an error message if the order of a <span class="SimpleMath">\(p\)</span>-quotient exceeds <span class="SimpleMath">\(p^{256}\)</span> or <span class="SimpleMath">\(p^{\textit{logord}}\)</span>, respectively. Note that the order of intermediate <span class="SimpleMath">\(p\)</span>-groups may be larger than the final order of a <span class="SimpleMath">\(p\)</span>-quotient.</p>

<p>The parameter <var class="Arg">ctype</var> determines the type of collector that is used for computations within the factor <var class="Arg">p</var>-group. <var class="Arg">ctype</var> must either be <code class="code">"single"</code> in which case a simple collector from the left is used or <code class="code">"combinatorial"</code> in which case a combinatorial collector from the left is used.</p>

<p><a id="X86EB30A7867EEF16" name="X86EB30A7867EEF16"></a></p>

<h5>47.14-2 EpimorphismQuotientSystem</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismQuotientSystem</code>( <var class="Arg">quotsys</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>For a quotient system <var class="Arg">quotsys</var> obtained from the function <code class="func">PQuotient</code> (<a href="chap47_mj.html#X7B5DDADC80F5796B"><span class="RefLink">47.14-1</span></a>), this operation returns an epimorphism <span class="SimpleMath">\(\textit{F} \rightarrow \textit{P}\)</span> where <span class="SimpleMath">\(\textit{F}\)</span> is the finitely presented group of which <var class="Arg">quotsys</var> is a quotient system and <span class="SimpleMath">\(\textit{P}\)</span> is a pc group isomorphic to the quotient of <var class="Arg">F</var> determined by <var class="Arg">quotsys</var>.</p>

<p>Different calls to this operation will create different groups <var class="Arg">P</var>, each with its own family.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">PQuotient( FreeGroup(2), 5, 10, 1024, "combinatorial" );</span>
&lt;5-quotient system of 5-class 10 with 520 generators&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">phi := EpimorphismQuotientSystem( last );</span>
[ f1, f2 ] -&gt; [ a1, a2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Collected( Factors( Size( Image( phi ) ) ) );</span>
[ [ 5, 520 ] ]
</pre></div>

<p><a id="X7CA738DB80B20D67" name="X7CA738DB80B20D67"></a></p>

<h5>47.14-3 EpimorphismPGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismPGroup</code>( <var class="Arg">fpgrp</var>, <var class="Arg">p</var>[, <var class="Arg">cl</var>] )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>computes an epimorphism from the finitely presented group <var class="Arg">fpgrp</var> to the largest <span class="SimpleMath">\(p\)</span>-group of <span class="SimpleMath">\(p\)</span>-class <var class="Arg">cl</var> which is a quotient of <var class="Arg">fpgrp</var>. If <var class="Arg">cl</var> is omitted, the largest finite <span class="SimpleMath">\(p\)</span>-group quotient (of <span class="SimpleMath">\(p\)</span>-class up to <span class="SimpleMath">\(1000\)</span>) is determined.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismPGroup(fp,2);</span>
[ f1, f2 ] -&gt; [ a1, a2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(Image(hom));</span>
8
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismPGroup(fp,3,7);</span>
[ f1, f2 ] -&gt; [ a1, a2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(Image(hom));</span>
6561
</pre></div>

<p><a id="X7CA20E2582DC45FD" name="X7CA20E2582DC45FD"></a></p>

<h5>47.14-4 EpimorphismNilpotentQuotient</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismNilpotentQuotient</code>( <var class="Arg">fpgrp</var>[, <var class="Arg">n</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>returns an epimorphism on the class <var class="Arg">n</var> finite nilpotent quotient of the finitely presented group <var class="Arg">fpgrp</var>. If <var class="Arg">n</var> is omitted, the largest finite nilpotent quotient (of <span class="SimpleMath">\(p\)</span>-class up to <span class="SimpleMath">\(1000\)</span>) is taken.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismNilpotentQuotient(fp,7);</span>
[ f1, f2 ] -&gt; [ f1*f4, f2*f5 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(Image(hom));</span>
52488
</pre></div>

<p>A related operation which is also applicable to finitely presented groups is <code class="func">GQuotients</code> (<a href="chap40_mj.html#X790C261184EEAB94"><span class="RefLink">40.9-4</span></a>), which computes all epimorphisms from a (finitely presented) group <var class="Arg">F</var> onto a given (finite) group <var class="Arg">G</var>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">GQuotients(fp,Group((1,2,3),(1,2)));</span>
[ [ f1, f2 ] -&gt; [ (1,2), (2,3) ], [ f1, f2 ] -&gt; [ (2,3), (1,2,3) ], 
  [ f1, f2 ] -&gt; [ (1,2,3), (2,3) ] ]
</pre></div>

<p><a id="X869F70CC818C946D" name="X869F70CC818C946D"></a></p>

<h5>47.14-5 SolvableQuotient</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SolvableQuotient</code>( <var class="Arg">F</var>, <var class="Arg">size</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SolvableQuotient</code>( <var class="Arg">F</var>, <var class="Arg">primes</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SolvableQuotient</code>( <var class="Arg">F</var>, <var class="Arg">tuples</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; SQ</code>( <var class="Arg">F</var>, <var class="Arg">...</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>This routine calls the solvable quotient algorithm for a finitely presented group <var class="Arg">F</var>. The quotient to be found can be specified in the following ways: Specifying an integer <var class="Arg">size</var> finds a quotient of size up to <var class="Arg">size</var> (if such large quotients exist). Specifying a list of primes in <var class="Arg">primes</var> finds the largest quotient involving the given primes. Finally <var class="Arg">tuples</var> can be used to prescribe a chief series.</p>

<p><code class="func">SQ</code> can be used as a synonym for <code class="func">SolvableQuotient</code>.</p>

<p><a id="X79A4D3B68110F48A" name="X79A4D3B68110F48A"></a></p>

<h5>47.14-6 EpimorphismSolvableQuotient</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; EpimorphismSolvableQuotient</code>( <var class="Arg">F</var>, <var class="Arg">param</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>computes an epimorphism from the finitely presented group <var class="Arg">fpgrp</var> to the largest solvable quotient given by <var class="Arg">param</var> (specified as in <code class="func">SolvableQuotient</code> (<a href="chap47_mj.html#X869F70CC818C946D"><span class="RefLink">47.14-5</span></a>)).</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f := FreeGroup( "a", "b", "c", "d" );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">fp := f / [ f.1^2, f.2^2, f.3^2, f.4^2, f.1*f.2*f.1*f.2*f.1*f.2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> f.2*f.3*f.2*f.3*f.2*f.3*f.2*f.3, f.3*f.4*f.3*f.4*f.3*f.4,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">f.1^-1*f.3^-1*f.1*f.3, f.1^-1*f.4^-1*f.1*f.4,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">f.2^-1*f.4^-1*f.2*f.4 ];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismSolvableQuotient(fp,300);Size(Image(hom));</span>
[ a, b, c, d ] -&gt; [ f1*f2, f1*f2, f2*f3, f2 ]
12
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismSolvableQuotient(fp,[2,3]);Size(Image(hom));</span>
[ a, b, c, d ] -&gt; [ f1*f2*f4, f1*f2*f6*f8, f2*f3, f2 ]
1152
</pre></div>

<p><a id="X81167847832DD3B1" name="X81167847832DD3B1"></a></p>

<h5>47.14-7 LargerQuotientBySubgroupAbelianization</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LargerQuotientBySubgroupAbelianization</code>( <var class="Arg">hom</var>, <var class="Arg">U</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Let <var class="Arg">hom</var> a homomorphism from a finitely presented group <span class="SimpleMath">\(G\)</span> to a finite group <span class="SimpleMath">\(H\)</span> and <span class="SimpleMath">\(\textit{U}\le H\)</span>. This function will -- if it exists -- return a subgroup <span class="SimpleMath">\(S\le\textit{G}\)</span>, such that the core of <span class="SimpleMath">\(S\)</span> is properly contained in the kernel of <var class="Arg">hom</var> as well as in <span class="SimpleMath">\(V'\)</span>, where <span class="SimpleMath">\(V\)</span> is the pre-image of <var class="Arg">U</var> under <var class="Arg">hom</var>. Thus <span class="SimpleMath">\(S\)</span> exposes a larger quotient of <span class="SimpleMath">\(G\)</span>. If no such subgroup exists, <var class="Arg">fail</var> is returned.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">f:=FreeGroup("x","y","z");;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=f/ParseRelators(f,"x^3=y^3=z^5=(xyx^2y^2)^2=(xz)^2=(yz^3)^2=1");</span>
&lt;fp group on the generators [ x, y, z ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">l:=LowIndexSubgroupsFpGroup(g,6);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">List(l,IndexInWholeGroup);</span>
[ 1, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">q:=DefiningQuotientHomomorphism(l[6]);;p:=Image(q);Size(p);</span>
Group([ (4,5,6), (1,2,3)(4,6,5), (2,4,6,3,5) ])
360
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">s:=LargerQuotientBySubgroupAbelianization(q,SylowSubgroup(p,3)); </span>
Group(&lt;fp, no generators known&gt;)
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Size(Image(DefiningQuotientHomomorphism(s))); </span>
193273528320
</pre></div>

<p><a id="X81451C4B8463B848" name="X81451C4B8463B848"></a></p>

<h4>47.15 <span class="Heading">Abelian Invariants for Subgroups</span></h4>

<p>Using variations of coset enumeration it is possible to compute the abelian invariants of a subgroup of a finitely presented group without computing a complete presentation for the subgroup in the first place. Typically, the operation <code class="func">AbelianInvariants</code> (<a href="chap39_mj.html#X812827937F403300"><span class="RefLink">39.16-1</span></a>) when called for subgroups should automatically take care of this, but in case you want to have further control about the methods used, the following operations might be of use.</p>

<p><a id="X83B63ED8826F4268" name="X83B63ED8826F4268"></a></p>

<h5>47.15-1 AbelianInvariantsSubgroupFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsSubgroupFpGroup</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p><code class="func">AbelianInvariantsSubgroupFpGroup</code> is a synonym for <code class="func">AbelianInvariantsSubgroupFpGroupRrs</code> (<a href="chap47_mj.html#X8586137B7AAA6C10"><span class="RefLink">47.15-3</span></a>).</p>

<p><a id="X804F664180BA2134" name="X804F664180BA2134"></a></p>

<h5>47.15-2 AbelianInvariantsSubgroupFpGroupMtc</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsSubgroupFpGroupMtc</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>uses the Modified Todd-Coxeter method to compute the abelian invariants of a subgroup <var class="Arg">H</var> of a finitely presented group <var class="Arg">G</var>.</p>

<p><a id="X8586137B7AAA6C10" name="X8586137B7AAA6C10"></a></p>

<h5>47.15-3 <span class="Heading">AbelianInvariantsSubgroupFpGroupRrs</span></h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsSubgroupFpGroupRrs</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsSubgroupFpGroupRrs</code>( <var class="Arg">G</var>, <var class="Arg">table</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>uses the Reduced Reidemeister-Schreier method to compute the abelian invariants of a subgroup <var class="Arg">H</var> of a finitely presented group <var class="Arg">G</var>.</p>

<p>Alternatively to the subgroup <var class="Arg">H</var>, its coset table <var class="Arg">table</var> in <var class="Arg">G</var> may be given as second argument.</p>

<p><a id="X850E4CD784F6EAA8" name="X850E4CD784F6EAA8"></a></p>

<h5>47.15-4 AbelianInvariantsNormalClosureFpGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsNormalClosureFpGroup</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p><code class="func">AbelianInvariantsNormalClosureFpGroup</code> is a synonym for <code class="func">AbelianInvariantsNormalClosureFpGroupRrs</code> (<a href="chap47_mj.html#X801635B28079E56A"><span class="RefLink">47.15-5</span></a>).</p>

<p><a id="X801635B28079E56A" name="X801635B28079E56A"></a></p>

<h5>47.15-5 AbelianInvariantsNormalClosureFpGroupRrs</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; AbelianInvariantsNormalClosureFpGroupRrs</code>( <var class="Arg">G</var>, <var class="Arg">H</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>uses the Reduced Reidemeister-Schreier method to compute the abelian invariants of the normal closure of a subgroup <var class="Arg">H</var> of a finitely presented group <var class="Arg">G</var>. See <a href="chap48_mj.html#X8118FECE7AD1879B"><span class="RefLink">48.2</span></a> for details on the different strategies.</p>

<p>The following example shows a calculation for the Coxeter group <span class="SimpleMath">\(B_1\)</span>. This calculation and a similar one for <span class="SimpleMath">\(B_0\)</span> have been used to prove that <span class="SimpleMath">\(B_1' / B_1'' \cong Z_2^9 \times Z^3\)</span> and <span class="SimpleMath">\(B_0' / B_0'' \cong Z_2^{91} \times Z^{27}\)</span> as stated in in <a href="chapBib_mj.html#biBFJNT95">[FJNT95, Proposition 5]</a>.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Define the Coxeter group E1.</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">F := FreeGroup( "x1", "x2", "x3", "x4", "x5" );</span>
&lt;free group on the generators [ x1, x2, x3, x4, x5 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">x1 := F.1;; x2 := F.2;; x3 := F.3;; x4 := F.4;; x5 := F.5;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">rels := [ x1^2, x2^2, x3^2, x4^2, x5^2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> (x1 * x3)^2, (x2 * x4)^2, (x1 * x2)^3, (x2 * x3)^3, (x3 * x4)^3,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> (x4 * x1)^3, (x1 * x5)^3, (x2 * x5)^2, (x3 * x5)^3, (x4 * x5)^2,</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput"> (x1 * x2 * x3 * x4 * x3 * x2)^2 ];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">E1 := F / rels;</span>
&lt;fp group on the generators [ x1, x2, x3, x4, x5 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">x1 := E1.1;; x2 := E1.2;; x3 := E1.3;; x4 := E1.4;; x5 := E1.5;;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Get normal subgroup generators for B1.</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">H := Subgroup( E1, [ x5 * x2^-1, x5 * x4^-1 ] );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Compute the abelian invariants of B1/B1'.</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">A := AbelianInvariantsNormalClosureFpGroup( E1, H );</span>
[ 2, 2, 2, 2, 2, 2, 2, 2 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Compute a presentation for B1.</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">P := PresentationNormalClosure( E1, H );</span>
&lt;presentation with 18 gens and 46 rels of total length 132&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">SimplifyPresentation( P );</span>
#I  there are 8 generators and 30 relators of total length 148
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">B1 := FpGroupPresentation( P );</span>
&lt;fp group on the generators [ _x1, _x2, _x3, _x4, _x6, _x7, _x8, _x11 
 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Compute normal subgroup generators for B1'.</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">gens := GeneratorsOfGroup( B1 );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">numgens := Length( gens );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">comms := [ ];;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">for i in [ 1 .. numgens - 1 ] do</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">    for j in [i+1 .. numgens ] do</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">        Add( comms, Comm( gens[i], gens[j] ) );</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">    od;</span>
<span class="GAPprompt">&gt;</span> <span class="GAPinput">od;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput"># Compute the abelian invariants of B1'/B1".</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">K := Subgroup( B1, comms );;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">A := AbelianInvariantsNormalClosureFpGroup( B1, K );</span>
[ 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2 ]
</pre></div>

<p><a id="X86C43E3B81ED25DC" name="X86C43E3B81ED25DC"></a></p>

<h4>47.16 <span class="Heading">Testing Finiteness of Finitely Presented Groups</span></h4>

<p>As a consequence of the algorithmic insolvabilities mentioned in the introduction to this chapter, there cannot be a general method that will test whether a given finitely presented group is actually finite.</p>

<p>Therefore testing the finiteness of a finitely presented group can be problematic. What <strong class="pkg">GAP</strong> actually does upon a call of <code class="func">IsFinite</code> (<a href="chap30_mj.html#X808A4061809A6E67"><span class="RefLink">30.4-2</span></a>) (or if it is –probably implicitly– asked for a faithful permutation representation) is to test whether it can find (via coset enumeration) a cyclic subgroup of finite index. If it can, it rewrites the presentation to this subgroup. Since the subgroup is cyclic, its size can be checked easily from the resulting presentation, the size of the whole group is the product of the index and the subgroup size. Since however no bound for the index of such a subgroup (if any exist) is known, such a test might continue unsuccessfully until memory is exhausted.</p>

<p>On the other hand, a couple of methods exist, that might prove that a group is infinite. Again, none is guaranteed to work in every case:</p>

<p>The first method is to find (for example via the low index algorithm, see <code class="func">LowIndexSubgroupsFpGroup</code> (<a href="chap47_mj.html#X85C5151380E19122"><span class="RefLink">47.10-1</span></a>)) a subgroup <span class="SimpleMath">\(U\)</span> such that <span class="SimpleMath">\([U:U']\)</span> is infinite. If <span class="SimpleMath">\(U\)</span> has finite index, this can be checked by <code class="func">IsInfiniteAbelianizationGroup</code> (<a href="chap47_mj.html#X82F444F67BE0E4FE"><span class="RefLink">47.16-1</span></a>).</p>

<p>Note that this test has been done traditionally by checking the <code class="func">AbelianInvariants</code> (<a href="chap39_mj.html#X812827937F403300"><span class="RefLink">39.16-1</span></a>) (see section <a href="chap47_mj.html#X81451C4B8463B848"><span class="RefLink">47.15</span></a>) of <span class="SimpleMath">\(U\)</span>, <code class="func">IsInfiniteAbelianizationGroup</code> (<a href="chap47_mj.html#X82F444F67BE0E4FE"><span class="RefLink">47.16-1</span></a>) does a similar calculation but stops as soon as it is known whether <span class="SimpleMath">\(0\)</span> is an invariant without computing the actual values. This can be notably faster.</p>

<p>Another method is based on <span class="SimpleMath">\(p\)</span>-group quotients, see <code class="func">NewmanInfinityCriterion</code> (<a href="chap47_mj.html#X85C9FD548394C1E2"><span class="RefLink">47.16-2</span></a>).</p>

<p><a id="X82F444F67BE0E4FE" name="X82F444F67BE0E4FE"></a></p>

<h5>47.16-1 IsInfiniteAbelianizationGroup</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; IsInfiniteAbelianizationGroup</code>( <var class="Arg">G</var> )</td><td class="tdright">(&nbsp;property&nbsp;)</td></tr></table></div>
<p>returns true if the commutator factor group <span class="SimpleMath">\(\textit{G}/\textit{G}'\)</span> is infinite. This might be done without computing the full structure of the commutator factor group.</p>

<p><a id="X85C9FD548394C1E2" name="X85C9FD548394C1E2"></a></p>

<h5>47.16-2 NewmanInfinityCriterion</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; NewmanInfinityCriterion</code>( <var class="Arg">G</var>, <var class="Arg">p</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Let <var class="Arg">G</var> be a finitely presented group and <var class="Arg">p</var> a prime that divides the order of the commutator factor group of <var class="Arg">G</var>. This function applies an infinity criterion due to M. F. Newman <a href="chapBib_mj.html#biBNew90">[New90]</a> to <var class="Arg">G</var>. (See <a href="chapBib_mj.html#biBJoh97">[Joh97, chapter 16]</a> for a more explicit description.) It returns <code class="keyw">true</code> if the criterion succeeds in proving that <var class="Arg">G</var> is infinite and <code class="keyw">fail</code> otherwise.</p>

<p>Note that the criterion uses the number of generators and relations in the presentation of <var class="Arg">G</var>. Reduction of the presentation via Tietze transformations (<code class="func">IsomorphismSimplifiedFpGroup</code> (<a href="chap47_mj.html#X78D87FA68233C401"><span class="RefLink">47.12-1</span></a>)) therefore might produce an isomorphic group, for which the criterion will work better.</p>


<div class="example"><pre>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">g:=FibonacciGroup(2,9);</span>
&lt;fp group on the generators [ f1, f2, f3, f4, f5, f6, f7, f8, f9 ]&gt;
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">hom:=EpimorphismNilpotentQuotient(g,2);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">k:=Kernel(hom);;</span>
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">Index(g,k);</span>
152
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">AbelianInvariants(k);</span>
[ 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5 ]
<span class="GAPprompt">gap&gt;</span> <span class="GAPinput">NewmanInfinityCriterion(Kernel(hom),5);</span>
true
</pre></div>

<p>This proves that the subgroup <code class="code">k</code> (and thus the whole group <code class="code">g</code>) is infinite. (This is the original example from <a href="chapBib_mj.html#biBNew90">[New90]</a>.)</p>


<div class="chlinkprevnextbot">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap46_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap48_mj.html">[Next Chapter]</a>&nbsp;  </div>


<div class="chlinkbot"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chap4_mj.html">4</a>  <a href="chap5_mj.html">5</a>  <a href="chap6_mj.html">6</a>  <a href="chap7_mj.html">7</a>  <a href="chap8_mj.html">8</a>  <a href="chap9_mj.html">9</a>  <a href="chap10_mj.html">10</a>  <a href="chap11_mj.html">11</a>  <a href="chap12_mj.html">12</a>  <a href="chap13_mj.html">13</a>  <a href="chap14_mj.html">14</a>  <a href="chap15_mj.html">15</a>  <a href="chap16_mj.html">16</a>  <a href="chap17_mj.html">17</a>  <a href="chap18_mj.html">18</a>  <a href="chap19_mj.html">19</a>  <a href="chap20_mj.html">20</a>  <a href="chap21_mj.html">21</a>  <a href="chap22_mj.html">22</a>  <a href="chap23_mj.html">23</a>  <a href="chap24_mj.html">24</a>  <a href="chap25_mj.html">25</a>  <a href="chap26_mj.html">26</a>  <a href="chap27_mj.html">27</a>  <a href="chap28_mj.html">28</a>  <a href="chap29_mj.html">29</a>  <a href="chap30_mj.html">30</a>  <a href="chap31_mj.html">31</a>  <a href="chap32_mj.html">32</a>  <a href="chap33_mj.html">33</a>  <a href="chap34_mj.html">34</a>  <a href="chap35_mj.html">35</a>  <a href="chap36_mj.html">36</a>  <a href="chap37_mj.html">37</a>  <a href="chap38_mj.html">38</a>  <a href="chap39_mj.html">39</a>  <a href="chap40_mj.html">40</a>  <a href="chap41_mj.html">41</a>  <a href="chap42_mj.html">42</a>  <a href="chap43_mj.html">43</a>  <a href="chap44_mj.html">44</a>  <a href="chap45_mj.html">45</a>  <a href="chap46_mj.html">46</a>  <a href="chap47_mj.html">47</a>  <a href="chap48_mj.html">48</a>  <a href="chap49_mj.html">49</a>  <a href="chap50_mj.html">50</a>  <a href="chap51_mj.html">51</a>  <a href="chap52_mj.html">52</a>  <a href="chap53_mj.html">53</a>  <a href="chap54_mj.html">54</a>  <a href="chap55_mj.html">55</a>  <a href="chap56_mj.html">56</a>  <a href="chap57_mj.html">57</a>  <a href="chap58_mj.html">58</a>  <a href="chap59_mj.html">59</a>  <a href="chap60_mj.html">60</a>  <a href="chap61_mj.html">61</a>  <a href="chap62_mj.html">62</a>  <a href="chap63_mj.html">63</a>  <a href="chap64_mj.html">64</a>  <a href="chap65_mj.html">65</a>  <a href="chap66_mj.html">66</a>  <a href="chap67_mj.html">67</a>  <a href="chap68_mj.html">68</a>  <a href="chap69_mj.html">69</a>  <a href="chap70_mj.html">70</a>  <a href="chap71_mj.html">71</a>  <a href="chap72_mj.html">72</a>  <a href="chap73_mj.html">73</a>  <a href="chap74_mj.html">74</a>  <a href="chap75_mj.html">75</a>  <a href="chap76_mj.html">76</a>  <a href="chap77_mj.html">77</a>  <a href="chap78_mj.html">78</a>  <a href="chap79_mj.html">79</a>  <a href="chap80_mj.html">80</a>  <a href="chap81_mj.html">81</a>  <a href="chap82_mj.html">82</a>  <a href="chap83_mj.html">83</a>  <a href="chap84_mj.html">84</a>  <a href="chap85_mj.html">85</a>  <a href="chap86_mj.html">86</a>  <a href="chap87_mj.html">87</a>  <a href="chapBib_mj.html">Bib</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<hr />
<p class="foot">generated by <a href="http://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p>
</body>
</html>
